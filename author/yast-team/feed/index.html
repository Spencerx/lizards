<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Yast Team &#8211; openSUSE Lizards</title>
	<atom:link href="https://lizards.opensuse.org/author/yast-team/feed/" rel="self" type="application/rss+xml" />
	<link>https://lizards.opensuse.org</link>
	<description>Blogs and Ramblings of the openSUSE Members</description>
	<lastBuildDate>Fri, 06 Mar 2020 11:29:40 +0000</lastBuildDate>
	<language>en-US</language>
	<sy:updatePeriod>hourly</sy:updatePeriod>
	<sy:updateFrequency>1</sy:updateFrequency>

	<item>
		<title>Highlights of YaST Development Sprint 94</title>
		<link>https://lizards.opensuse.org/2020/03/06/yast-sprint-94/</link>
		<comments>https://lizards.opensuse.org/2020/03/06/yast-sprint-94/#comments</comments>
		<pubDate>Fri, 06 Mar 2020 11:29:40 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Distribution]]></category>
		<category><![CDATA[Factory]]></category>
		<category><![CDATA[Hackweek]]></category>
		<category><![CDATA[Programming]]></category>
		<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[YaST]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=14350</guid>
		<description><![CDATA[After some time of silent work (our previous blog post was published a month ago), the YaST Team is back with some news about the latest development sprint and some Hack Week experiments. Those news include: Enabling YaST on the Windows Subsystem for Linux Usability improvements for the Online Search, the Partitioner and the Kdump [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>After some time of silent work (our <a href="https://lizards.opensuse.org/2020/02/07/yast-sprint-93">previous blog post</a> was published a month ago), the YaST Team is back with some news about the latest development sprint and some <a href="https://hackweek.suse.com/">Hack Week</a> experiments. Those news include:</p>
<ul>
<li>Enabling YaST on the Windows Subsystem for Linux</li>
<li>Usability improvements for the Online Search, the Partitioner and the Kdump module</li>
<li>Better control of overridden <code>sysctl</code> configuration values</li>
<li>Improvements in the default selections of the upcoming SLE 15 SP2 installer</li>
<li>New features for zSeries mainframes like Secure Boot and I/O devices auto-configuration</li>
<li>And, as a bonus, a couple of Hack Week projects related to YaST, Ruby and Crystal</a>
</ul>
<p>So, as you can see, we have a little bit of everything in the menu, from WSL to mainframes, from new features to small usability improvements, from installation to system fine-tuning&#8230; So let&#8217;s dive into the details!</p>
<h3 id="wsl">Improved compatibility with WSL</h3>
<p>Have you ever heard about <a href="https://en.wikipedia.org/wiki/Windows_Subsystem_for_Linux">WSL</a>, the Windows Subsystem for Linux? To be honest, before this sprint we haven&#8217;t payed much attention to it either. But as both openSUSE Leap and SUSE Linux Enterprise (SLE) are available to Windows users via WSL images and the 15.2 releases of both distributions are approaching, we decided it was time to dive into WSL to research how it works and how can YaST be useful there.</p>
<p>Setting up an (open)SUSE test system inside a WSL environment was a piece of cake thanks to the <a href="https://en.opensuse.org/openSUSE:WSL">excellent documentation</a> at the openSUSE Wiki.</p>
<p>Many components of YaST are useless in WSL because not everything can actually be configured from the Linux system itself and because systemd is not available (we are talking exclusively about WSL1 here). But YaST is still very useful for the initial setup of the system when running the (open)SUSE image for the first time. It can be used to setup the first user, to confirm the license and, in the SLE case, also to register the system. The YaST modules for software management can also be very handy to customize the image at any point after that initial setup.</p>
<p>So far, we have done three changes to improve the experience of executing YaST within WSL.</p>
<ul>
<li>We increased the speed of the initial boot by removing calls to systemd when it is not available.</li>
<li>We fixed the registration process for YaST Firstboot.</li>
<li>We implemented a feature to explicitly mark YaST modules that work in WSL and show only those modules in the YaST control center.
</li>
</ul>
<p>We also documented all our findings about WSL in <a href="https://yastgithubio.readthedocs.io/en/latest/WSL/">this document</a>.</p>
<p>As always, we are hungry for feedback. Please reach out to us and tell us what&#8217;s your experience using YaST inside WSL and which modules do you miss the most.</p>
<h3 id="online-search">Improving the UX of the Online Search</h3>
<p>As we <a href="https://lizards.opensuse.org/2020/02/07/yast-sprint-93/#the-online-search-feature-comes-to-yast">announced</a> one month ago, YaST will offer a mechanism to search for packages through all SUSE Linux Enterprise modules, even if they are not registered. This feature, known as <em>package online search</em>, was already available using zypper&#8217;s <code>search-packages</code> command or through the <a href="https://scc.suse.com/packages">SCC web interface</a>.</p>
<p>After gathering some feedback during the sprint review meeting, we decided to invest some time improving the overall UX experience. Perhaps the most relevant change is the new summary screen, which shows the list of modules to activate and packages to install. </p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/03/online-search.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/03/online-search-300x153.png" alt="New summary screen for the online search" width="300" height="153" class="aligncenter size-medium wp-image-14352" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/03/online-search-300x153.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/03/online-search-768x391.png 768w, https://lizards.opensuse.org/wp-content/uploads/2020/03/online-search-1024x521.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2020/03/online-search.png 1263w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Additionally, we improved error handling and, by the way, we fixed the <em>case sensitive</em> filter.</p>
<h3 id="partitioner-ux">&#8230;And the Partitioner as Well</h3>
<p>The online search is not the only part of YaST that has received some love in the UX area. We also tried to improve a bit the usability of the Partitioner. In this occasion, based on the feedback coming from our users via <a href="http://bugzilla.opensuse.org">openSUSE&#8217;s Bugzilla</a>.</p>
<p>On one hand, we got a report about this dialog been too long to properly fit in low screen resolutions.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/03/mount-old-qt.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/03/mount-old-qt-193x300.png" alt="Previous dialog for mount options" width="193" height="300" class="aligncenter size-medium wp-image-14356" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/03/mount-old-qt-193x300.png 193w, https://lizards.opensuse.org/wp-content/uploads/2020/03/mount-old-qt.png 400w" sizes="(max-width: 193px) 100vw, 193px" /></a></p>
<p>The result was even worse in a text console with a resolution of 80 columns and 24 lines, which is the minimum size we design all YaST screens to work on.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/03/mount-old-curses.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/03/mount-old-curses-300x181.png" alt="Previous text-based dialog for mount options" width="300" height="181" class="aligncenter size-medium wp-image-14357" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/03/mount-old-curses-300x181.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/03/mount-old-curses.png 642w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>So we dropped some obsolete options and made others more compact. Now the dialog fits in 24 lines again.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/03/mount-new-curses.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/03/mount-new-curses-300x189.png" alt="Revamped text-based dialog for mount options" width="300" height="189" class="aligncenter size-medium wp-image-14358" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/03/mount-new-curses-300x189.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/03/mount-new-curses.png 641w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>And, as you can see below, it looks also nicer (or at least less overwhelming) in graphical mode as well. It&#8217;s worth mentioning we also took the opportunity to fix other related dialogs that had similar problems.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/03/mount-new-qt.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/03/mount-new-qt-300x273.png" alt="Revamped dialog for mount options" width="300" height="273" class="aligncenter size-medium wp-image-14359" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/03/mount-new-qt-300x273.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/03/mount-new-qt.png 519w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>On the other hand, we also got a report about how inconvenient was to always jump to the first tab when a device was selected in the devices tree at the left of the Partitioner, forcing the user to click in the &#8220;Partitions&#8221; tab (or any other desired one) over and over.</p>
<p>In that regard and as you may remember, a couple of sprints ago <a href="https://lizards.opensuse.org/2020/01/24/highlights-of-yast-development-sprint-92/#an-actionable-partitioner-overview-screen" rel="nofollow">we made the overview screen <em>actionable</em></a>, avoiding the navigation to the device page just to perform a simple action over it. But navigating through the different devices back and forth is still possible and useful. Now such navigation has been improved by remembering the last tab and row selected per section or device whenever possible, which will save you a bunch of clicks when working with multiple devices.</p>
<p>Related to this, <a href="https://lists.opensuse.org/yast-devel/2020-01/msg00014.html">we started a public discussion</a> about what should be the default tab the first time a device is visited. Once again, we are looking for opinions. So we would be grateful if you read the thread and contribute to the discussion.</p>
<h3 id="kdump">Showing Suggested Values for Kdump Configuration</h3>
<p>But the Partitioner was not the only YaST module for which our users pointed usability problems via Bugzilla. After some changes in how Kdump works after the migration from openSUSE Leap 42.3 to 15.0, it turned out that using YaST to re-adjust the values was not as helpful as it should be. YaST Kdump displayed the current size of the memory reservations, as well as the min and max margins. But it did not show the recommended default values for the current system, so if the user has adjusted the limits in the past it was impossible to get an up-to-date proposal from YaST calculated for the current system.</p>
<p>We have adapted the dialog to show those suggested values. As you can see below, we also took the opportunity to extend the help text to explain the meaning of the different values.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/03/kdump.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/03/kdump-300x194.png" alt="New Kdump configuration screen" width="300" height="194" class="aligncenter size-medium wp-image-14367" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/03/kdump-300x194.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/03/kdump-768x496.png 768w, https://lizards.opensuse.org/wp-content/uploads/2020/03/kdump-1024x661.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2020/03/kdump.png 1177w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3 id="sysctl">Better Control of Overridden Kernel Parameter Values</h3>
<p>And talking about YaST pieces we are improving step by step, you may remember from <a href="https://lizards.opensuse.org/2019/10/09/highlights-of-yast-development-sprint-86">our report of sprint 86</a> that we are adapting YaST to deal with the new structure of the <code>sysctl</code> configuration.</p>
<p>Up to now YaST has stored <code>sysctl</code> values mainly in <code>/etc/sysctl.conf</code> and <code>/etc/sysctl.d/70-yast.conf</code>. But this reflects only a part of the possibilities for storing those values. The truth is that there are many more locations where these settings can be stored: <code>/run/sysctl.d</code>, <code>/etc/sysctl.d</code>, <code>/usr/local/lib/sysctl.d</code>, <code>/usr/lib/sysctl.d</code>, <code>/lib/sysctl.d</code>, <code>/etc/sysctl.conf</code>&#8230;</p>
<p>Now YaST also takes care of these locations and informs the user if there are some conflicting values, as you can see in the following screenshot.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/03/sysctl.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/03/sysctl-300x233.png" alt="YaST alerting about conflicts in sysctl" width="300" height="233" class="aligncenter size-medium wp-image-14355" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/03/sysctl-300x233.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/03/sysctl-768x596.png 768w, https://lizards.opensuse.org/wp-content/uploads/2020/03/sysctl.png 800w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3 id="sle-modules">The Default Pre-selected SLE Modules</h3>
<p>We have also invested some time smoothing some rough edges off the installation process for the upcoming openSUSE 15.2 and SLE 15 SP2. For example, if you register your SLE 15 product during installation you will see the available modules and extensions in the following dialog. Some of them are by default pre-selected because they either contain the base system components (kernel, glibc,&#8230;) or the product specific packages (e.g. GNOME for SLE Desktop).</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/03/modules.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/03/modules-300x214.png" alt="Modules selection during SLE installation" width="300" height="214" class="aligncenter size-medium wp-image-14362" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/03/modules-300x214.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/03/modules.png 740w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>However, if you skip the registration and use the packages from the DVD medium there were no modules or extension pre-selected. The problem is that the information about the default modules was only available in the <a href="https://scc.suse.com">SCC</a> data which obviously is not available in an offline installation.</p>
<p>In SLE 15 SP2 we added this extra information to the installer configuration files so now also in an offline installation YaST can preselect the default modules for each product.</p>
<h3 id="ntp">Proposing NTP Servers During Installation</h3>
<p>And talking about offering sensible defaults for installation, we also improved the situation regarding the configuration of the NTP server. For openSUSE based systems (including Kubic) and a few SUSE products, like CaaSP or SLE High Performance Computing, YaST sets up the NTP daemon during installation. YaST tries to determine which server to use through the DHCP information but, when it is not available, it will propose one from openSUSE and SUSE pools (e.g., <code>n.opensuse.pool.ntp.org</code> where <code>n</code> is a number between 0 and 3).</p>
<p>However, we still were using the <code>novell.pool.ntp.org</code> pool for SUSE based products. During this sprint, we have switched to the <code>suse.pool.ntp.org</code> pool of servers and, additionally, we have refactored some code in order to reduce duplication and improve testability.</p>
<h3 id="secure-boot">Secure Boot Support for IBM zSeries</h3>
<p>You may have noticed by the recent sprint reports that we are improving several aspects related to the installation and configuration of zSeries mainframes. This sprint was not an exception&#8230; and will certainly not be the last one in that regard. </p>
<p>As a result of that effort, YaST now supports the Secure Boot feature found on the latest zSeries machines. It&#8217;s rather similar to the existing UEFI Secure Boot so we took the opportunity to unify the Secure Boot handling found on different architectures.</p>
<p>This means you get this checkbox if your zSeries machine does have Secure Boot support.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/03/secure-boot.jpg"><img src="//lizards.opensuse.org/wp-content/uploads/2020/03/secure-boot-300x165.jpg" alt="Configuring Secure Boot in zSeries" width="300" height="165" class="aligncenter size-medium wp-image-14363" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/03/secure-boot-300x165.jpg 300w, https://lizards.opensuse.org/wp-content/uploads/2020/03/secure-boot.jpg 606w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>In addition, we added a shortcut link on the installation summary screen that lets you enable Secure Boot with just a click.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/03/secure-boot-proposal.jpg"><img src="//lizards.opensuse.org/wp-content/uploads/2020/03/secure-boot-proposal-300x165.jpg" alt="Secure Boot in the proposal screen" width="300" height="165" class="aligncenter size-medium wp-image-14364" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/03/secure-boot-proposal-300x165.jpg 300w, https://lizards.opensuse.org/wp-content/uploads/2020/03/secure-boot-proposal.jpg 606w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>As mentioned, we took the opportunity to unify the management of Secure Boot in all platforms, so this new shortcut link is also available in x86_64 or aarch64 machines that have UEFI Secure Boot.</p>
<h3 id="chzdev">Automatic Configuration of I/O Devices in zSeries</h3>
<p>And talking about zSeries mainframes, anyone having used Linux in one of those systems know that input/output devices, like disks or network cards, must be configured and activated before they can be detected and used normally by the operating system.</p>
<p>But thanks to the new I/O device auto-configuration mechanism, users can now specify IDs and settings of I/O devices that should be automatically enabled in Linux. We modified the installer to detect such configuration and trigger the corresponding configuration actions, removing the need of manually activating disks and network devices during the installation process.</p>
<p>This is still an experimental feature and we are waiting for feedback to make sure the current implementation works in all the desired scenarios. If everything goes as expected, the feature will debut in SLE 15 SP2.</p>
<h3 id="hackweek">Hack Week</h3>
<p>As said at the beginning of the post, the main reason for spending almost a month without publishing any report was that the whole YaST Team at SUSE was diving into completely different topics due to <a href="https://hackweek.suse.com/">Hack Week 19</a>, which theme was &#8220;Simplify, Modernize and Accelerate&#8221;.</p>
<p>There were not many projects related to YaST in this edition of Hack Week, but there are at least two that could be interesting for YaST fans and contributors. Fortunately, we have published reports for both of them in the yast-devel mailing list. So check out the results of &#8220;<a href="https://lists.opensuse.org/yast-devel/2020-02/msg00024.html">Learn Crystal by Porting Part of YaST to that Language</a>&#8221; and &#8220;<a href="https://lists.opensuse.org/yast-devel/2020-02/msg00026.html">YaST Logs Analyzer</a>&#8220;.</p>
<h3 id="closing">More to come</h3>
<p>Now that we are back to our usual development pace, we should have more news about YaST development in a couple of weeks. The plan is to focus on fixing bugs for the upcoming releases of openSUSE Leap and SUSE Enterprise Linux, but we are pretty sure we will still find interesting bits of information for you.</p>
<p>Meanwhile, keep in touch through the usual channels and have a lot of fun!</p>
]]></content:encoded>
			<wfw:commentRss>https://lizards.opensuse.org/2020/03/06/yast-sprint-94/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
		<item>
		<title>Highlights of YaST Development Sprint 93</title>
		<link>https://lizards.opensuse.org/2020/02/07/yast-sprint-93/</link>
		<comments>https://lizards.opensuse.org/2020/02/07/yast-sprint-93/#comments</comments>
		<pubDate>Fri, 07 Feb 2020 16:31:11 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Base System]]></category>
		<category><![CDATA[Distribution]]></category>
		<category><![CDATA[Factory]]></category>
		<category><![CDATA[Hackweek]]></category>
		<category><![CDATA[Network]]></category>
		<category><![CDATA[Software Management]]></category>
		<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[YaST]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=14311</guid>
		<description><![CDATA[Lately, the YaST team has been quite busy fixing bugs and finishing some features for the upcoming (open)SUSE releases. Although we did quite some things, in this report we will have a closer look at just a few topics: A feature to search for packages across all SLE modules has arrived to YaST. Improved support [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>Lately, the YaST team has been quite busy fixing bugs and finishing some features for the upcoming (open)SUSE releases. Although we did quite some things, in this report we will have a closer look at just a few topics:</p>
<ul>
<li>A feature to search for packages across all SLE modules has arrived to YaST.</li>
<li>Improved support for S390 systems in the network module.</li>
<li>YaST command-line interface now returns a proper exit-code.</li>
<li>Added progress feedback to the Expert Partitioner.</li>
<li>Partial support for Bitlocker and, as a lesson learned from that, a new warning about resizing empty partitions.</li>
</ul>
<h3 id="the-online-search-feature-comes-to-yast">The Online Search Feature Comes to YaST</h3>
<p>As you already know, starting in version 15, SUSE Linux follows a modular approach. Apart from the base products, the packages are spread through a set of different modules that the user can enable if needed (Basesystem module, Desktop Applications Module, Server Applications Module, Development Tools Module, you name it).</p>
<p>In this situation, you may want to install a package, but you do not know which module contains such a package. As YaST only knows the data of those packages included in your registered modules, you will have to do a manual search.</p>
<p>Fortunately, zypper introduced a new <code>search-packages</code> command some time ago that allows to find out where a given package is. And now it is time to bring this feature to YaST.</p>
<p>For technical reasons, this online search feature cannot be implemented within the package manager, so it is available via the <em>Extra</em> menu.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/02/search-online-menu-option.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/02/search-online-menu-option-300x207.png" alt="Search Online Menu Option" width="300" height="207" class="aligncenter size-medium wp-image-14315" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/02/search-online-menu-option-300x207.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/02/search-online-menu-option-768x531.png 768w, https://lizards.opensuse.org/wp-content/uploads/2020/02/search-online-menu-option-1024x708.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2020/02/search-online-menu-option.png 1052w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>YaST offers a simple way to search for the package you want across all available modules and extensions, no matter whether they are registered or not. And, if you find the package you want, it will ask you about activating the needed module/extension right away so you can finally install the package.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/02/online-search-enable-containers-module.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/02/online-search-enable-containers-module-300x207.png" alt="Online Search: Enable Containers Module" width="300" height="207" class="aligncenter size-medium wp-image-14313" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/02/online-search-enable-containers-module-300x207.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/02/online-search-enable-containers-module-768x531.png 768w, https://lizards.opensuse.org/wp-content/uploads/2020/02/online-search-enable-containers-module-1024x708.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2020/02/online-search-enable-containers-module.png 1050w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>If you want to see this feature in action, check out the <a href="//lizards.opensuse.org/wp-content/uploads/2020/02/online-search-install-php7.webm">demonstration video</a>. Like any other new YaST feature, we are looking forward to your feedback.</p>
<h3 id="fixing-and-improving-network-support-for-S390-systems">Fixing and Improving Network Support for S390 Systems</h3>
<p>We have mentioned a lot of times that we recently refactored the Network module, fixing some long-standing bugs and preparing the code for the future. However, as a result, we introduced a few new bugs too. One of those bugs was dropping, by accident, the network devices activation dialog for S390 systems. Thus, during this sprint, we re-introduced the dialog and, what is more, we did a few improvements as the old one was pretty tricky. Let&#8217;s have a look at them.</p>
<p>The first obvious change is that the overview shows only one line per each s390 group device, instead of using one row per each channel as the old did.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/02/yast2-network-s390-new-overview.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/02/yast2-network-s390-new-overview-300x239.png" alt="New YaST Network Overview for S390 Systems" width="300" height="239" class="aligncenter size-medium wp-image-14318" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/02/yast2-network-s390-new-overview-300x239.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/02/yast2-network-s390-new-overview-768x611.png 768w, https://lizards.opensuse.org/wp-content/uploads/2020/02/yast2-network-s390-new-overview.png 927w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Moreover, the overview will be updated after the activation, displaying the Linux device that corresponds to the just activated device.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/02/yast2-network-s390-overview-after-activation.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/02/yast2-network-s390-overview-after-activation-300x190.png" alt="YaST2 Network Overview After Activation" width="300" height="190" class="aligncenter size-medium wp-image-14321" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/02/yast2-network-s390-overview-after-activation-300x190.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/02/yast2-network-s390-overview-after-activation.png 723w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Last but not least, we have improved the error reporting too. Now, when the activation fails, YaST will give more details in order to help the user to solve the problem.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/02/yast2-network-s390-error-reporting.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/02/yast2-network-s390-error-reporting-300x239.png" alt="YaST2 Network Error Reporting in S390 Systems" width="300" height="239" class="aligncenter size-medium wp-image-14319" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/02/yast2-network-s390-error-reporting-300x239.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/02/yast2-network-s390-error-reporting-768x613.png 768w, https://lizards.opensuse.org/wp-content/uploads/2020/02/yast2-network-s390-error-reporting.png 926w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3 id="fixing-the-cli">Fixing the CLI</h3>
<p>YaST command-line interface is a rather unknown feature, although it has been there since ever. Recently, we got some bug reports about its exit codes. We discovered that, due to a technical limitation of our internal API, it always returned a non-zero exit code on any command that was just reading values but not writing anything. Fortunately, we were able to fix the problem and, by the way, we improved the behavior in several situations where, although the exit code was non-zero, YaST did not give any feedback. Now that the CLI works again, it is maybe time to give it a try, especially if it is the first time you hear about it.</p>
<h3 id="yast2-partitioner-feedback">Adding Progress Feedback to the Partitioner</h3>
<p>The <em>Expert Partitioner</em> is a very powerful tool. It allows you to perform very complex configurations in your storage devices. At every time you can check the changes you have been doing in your devices by using the Installation Summary option on the left bar. All those changes will not be applied on the system until you confirm them by clicking the Next button. But once you confirm the changes, the Expert Partitioner simply closes without giving feedback about the progress of the changes being performed.</p>
<p>Actually, this is a kind of regression after migrating YaST to its new Storage Stack (a.k.a. storage-ng). The old Partitioner had a final step which did inform the user about the progress of the changes. That dialog has been brought back, allowing you to be aware of what is happening once you decide to apply the configuration. This progress dialog will be available in SLE 15 SP2, openSUSE 15.2 and, of course, openSUSE Tumbleweed.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/02/yast2-storage-ng-progress-feedback.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/02/yast2-storage-ng-progress-feedback-300x155.png" alt="YaST Partitioner Progress Feedback" width="300" height="155" class="aligncenter size-medium wp-image-14325" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/02/yast2-storage-ng-progress-feedback-300x155.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/02/yast2-storage-ng-progress-feedback-768x397.png 768w, https://lizards.opensuse.org/wp-content/uploads/2020/02/yast2-storage-ng-progress-feedback.png 957w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3 id="bitlocker">Recognizing Bitlocker Partitions</h3>
<p><a href="https://en.wikipedia.org/wiki/BitLocker">Bitlocker</a> is a filesystem encrypting technology that comes included with Windows. Until the previous sprint, YaST was not able to recognize that a given partition was encrypted with such technology.</p>
<p>As a consequence, the automatic partitioning proposal of the (open)SUSE installer would happily delete any partition encrypted with Bitlocker to reclaim its space, even for users that had specified they wanted to keep Windows untouched. Moreover, YaST would allow users to resize such partitions using the Expert Partitioner without any warning (more about that below).</p>
<p>All that is fixed. Now Bitlocker partitions are correctly detected and displayed as such in the Partitioner, which will not allow users to resize them, explaining that such operation is not supported. And the installer&#8217;s Guided Setup will consider those partitions to be part of a Windows installation for all matters.</p>
<h3 id="beware-of-empty-partitions">Beware of Empty Partitions</h3>
<p>As explained before, whenever YaST is unable to recognize the content of a partition or a disk, it considers such device to be empty. Although that&#8217;s not longer the case for Bitlocker devices, there are many more technologies out there (and more to come). So users should not blindly trust that a partition displayed as empty in the YaST Partitioner can actually be resized safely.</p>
<p>In order to prevent data loss, in the future YaST will inform the user about a potential problem when trying to resize a partition that looks empty.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/02/yast2-storage-ng-empty-partition-warning-message.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/02/yast2-storage-ng-empty-partition-warning-message-300x180.png" alt="YaST&quot; Expert Partitioning Warning when Resizing Empty Partitions" width="300" height="180" class="aligncenter size-medium wp-image-14329" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/02/yast2-storage-ng-empty-partition-warning-message-300x180.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/02/yast2-storage-ng-empty-partition-warning-message.png 355w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3 id="hack-week-is-coming">Hack Week is coming&#8230;</h3>
<p>That special time of the year is already around the corner. Christmas? No, Hack Week! From February 10 to February 14 we will be celebrating the 19th Hack Week at SUSE. The theme of this edition is <em>Simplify, Modernize &amp; Accelerate</em>. If you are curious about the projects that we are considering, have a look at <a href="https://hackweek.suse.com/">SUSE Hack Week&#8217;s Page</a>. Bear in mind that the event is not limited to SUSE employees, so if you are interested in any project, do not hesitate to join us.</p>
]]></content:encoded>
			<wfw:commentRss>https://lizards.opensuse.org/2020/02/07/yast-sprint-93/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>Highlights of YaST Development Sprint 92</title>
		<link>https://lizards.opensuse.org/2020/01/24/highlights-of-yast-development-sprint-92/</link>
		<pubDate>Fri, 24 Jan 2020 15:35:49 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[Uncategorized]]></category>
		<category><![CDATA[YaST]]></category>
		<category><![CDATA[faster]]></category>
		<category><![CDATA[installation]]></category>
		<category><![CDATA[nfs]]></category>
		<category><![CDATA[partitioner]]></category>
		<category><![CDATA[progress]]></category>
		<category><![CDATA[retracted]]></category>
		<category><![CDATA[table]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=14289</guid>
		<description><![CDATA[Partitioner: An Actionable Overview Screen Not only Partitioner: Numeric Sorting in Tables Improving the NFS Module Package Installation: Installation Progress Improvements Doomsday Preparations: Retracted Packages Qt Package Selection Gets Faster An Actionable Partitioner Overview Screen Until now, the Partitioner landing screen has been useful to have a big picture of the devices in your system [&#8230;]]]></description>
				<content:encoded><![CDATA[<ul>
<li><a href="#an-actionable-partitioner-overview-screen">Partitioner: An Actionable Overview Screen</a></li>
<li><a href="#numeric-sorting-in-tables">Not only Partitioner: Numeric Sorting in Tables</a></li>
<li><a href="#improving-the-nfs-module">Improving the NFS Module</a></li>
<li>Package Installation:
<ul>
<li><a href="#installation-progress-improvements">Installation Progress Improvements</a></li>
<li><a href="#doomsday-preparations-retracted-packages">Doomsday Preparations: Retracted Packages</a></li>
<li><a href="#qt-package-selection-gets-faster">Qt Package Selection Gets Faster</a></li>
</ul>
</li>
</ul>
<h3 id="an-actionable-partitioner-overview-screen">An Actionable Partitioner Overview Screen</h3>
<p>Until now, the Partitioner landing screen has been useful to have a big picture of the devices in your system and as a shortcut to jump directly to the device page just with a double click over it. But, do you know what? From yast-storage-ng 4.2.74 on you can work directly with devices from that screen similar as you already do in the more specific pages, through the contextual actions added below the devices list. That means, for example, no more jumps to Hard Disks just to add a new partition nor resize an existing one. Enjoy <img src="https://s.w.org/images/core/emoji/2.2.1/72x72/1f609.png" alt="&#x1f609;" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
<figure><a href="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-01-part.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-01-part-300x225.png" alt="" width="300" height="225" class="aligncenter size-medium wp-image-14290" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-01-part-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-01-part-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-01-part.png 800w" sizes="(max-width: 300px) 100vw, 300px" /></a><br />
</figure>
<p>More details: <a href="https://github.com/yast/yast-storage-ng/pull/1024">PR 1024</a></p>
<h3 id="numeric-sorting-in-tables">Numeric Sorting in Tables</h3>
<p>We have improved the sorting for tables in <a href="https://github.com/libyui">libyui</a>, the UI library of YaST. So far columns were sorted directly by the text displayed, e.g. the device name or the size in the expert partitioner. For some use-cases this resulted in unexpected ordering, e.g. partitions of a disk were ordered “/dev/sda1”, “/dev/sda10”, “/dev/sda2”, and sizes were ordered “1 GiB”, “2 TiB” and “4 GiB”.</p>
<p>Now it is possible to <a href="https://github.com/yast/yast-ycp-ui-bindings/blob/master/examples/Table-sort-key.rb">provide a sort-key for every table entry</a> which is then used instead of the displayed text. This allows the expected ordering and is already implemented for the tables in the expert partitioner as the two pictures below show.</p>
<figure><a href="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-02-num1.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-02-num1-300x228.png" alt="" width="300" height="228" class="aligncenter size-medium wp-image-14291" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-02-num1-300x228.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-02-num1.png 733w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-03-num2.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-03-num2-300x240.png" alt="" width="300" height="240" class="aligncenter size-medium wp-image-14292" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-03-num2-300x240.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-03-num2.png 765w" sizes="(max-width: 300px) 100vw, 300px" /></a><br />
</figure>
<h3 id="improving-the-nfs-module">Improving the NFS Module</h3>
<p>YaST offers a specific module to configure your <a href="https://en.wikipedia.org/wiki/Network_File_System">NFS</a> shares. Similar to every YaST module, you can run it by executing <code>yast2 nfs</code> in your terminal, or by launching it from the YaST Control Center. But there is another cool way to use the YaST NFS module: opening the Expert Partitioner!</p>
<figure><a href="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-04-nfs.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-04-nfs-300x201.png" alt="" width="300" height="201" class="aligncenter size-medium wp-image-14293" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-04-nfs-300x201.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-04-nfs.png 715w" sizes="(max-width: 300px) 100vw, 300px" /></a><br />
</figure>
<p>The Expert Partitioner offers a NFS section on the left menu tree where you can do everything that the NFS module provides. Thanks to that, you can configure your NFS shares at the same time you format your partitions!</p>
<p>But that integration needed some improvements after we migrated YaST to the new Storage Stack (a.k.a. storage-ng). Moreover, some bugs were detected when using the NFS module for mounting and unmounting shares, see for example <a href="https://bugzilla.suse.com/show_bug.cgi?id=1006815">bsc#1006815</a> and <a href="https://bugzilla.suse.com/show_bug.cgi?id=1151426">bsc#1151426</a>.</p>
<p>All those bugs were fixed, ww the NFS module behaves as expected in both cases, when running in standalone mode and inside the Expert Partitioner. Note that now the current status of the existing shares is preserved. That is, an unmounted share will continue unmounted after editing it. Unmounted entries are indicated with an asterisk in the list of shares, similar to what the Expert Partitioner does for the rest of unmounted devices. All these improvements will be available for SUSE Linux Enterprise SP1, openSUSE Leap 15.1 and openSUSE Tumbleweed.</p>
<figure><a href="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-05-nfs2.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-05-nfs2-300x210.png" alt="" width="300" height="210" class="aligncenter size-medium wp-image-14294" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-05-nfs2-300x210.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-05-nfs2.png 530w" sizes="(max-width: 300px) 100vw, 300px" /></a><br />
</figure>
<h3 id="installation-progress-improvements">Installation Progress Improvements</h3>
<p>We got some bug reports about how installation progress reporting works and while we were touching it, we also added a few smaller improvements to the code.</p>
<p>The first change is that nowadays installing from multiple discs almost never happens but still there was always a “<strong>Medium 1</strong>” column which did not make much sense. So we removed the column and if there is a multi-media source, it will be appended to the name if needed.</p>
<p>The second visible change is a new Unicode character ⌛ (<strong>hourglass</strong>) during the initial phase of RPM installation until the remaining time can be estimated.</p>
<p>The third change is that now the maximum time is always capped at 2 hours, so even if there are multiple sources and some of them took more then two hours, it always show just “<strong>&gt;2:00:00</strong>” and even in total it is capped, so it can no longer show something like “&gt;6:00:00”.</p>
<p>The fourth one is that now you can read the <strong>release notes</strong> without disturbances. Previously you would get switched to the package log tab after each package finished its installation. Now it will redraw only when you go back from the release notes screen.</p>
<p>The fifth one is a fix for showing the <strong>remaining packages</strong>, where it is shown only for the active source and not for all. So now it shows remaining packages for all repositories.</p>
<p>And last but not least we do a bunch of refactoring, code quality improvements and also adding automatic unit tests to reduce regressions in the future.</p>
<p>Tumbleweed before and now:</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-06-inst1.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-06-inst1-300x225.png" alt="" width="300" height="225" class="aligncenter size-medium wp-image-14295" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-06-inst1-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-06-inst1-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-06-inst1.png 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a> </p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-07-inst2.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-07-inst2-300x225.png" alt="" width="300" height="225" class="aligncenter size-medium wp-image-14296" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-07-inst2-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-07-inst2-768x577.png 768w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-07-inst2-1024x769.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-07-inst2.png 1025w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>SLE before and now:</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-08-inst3.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-08-inst3-300x225.png" alt="" width="300" height="225" class="aligncenter size-medium wp-image-14297" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-08-inst3-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-08-inst3-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-08-inst3.png 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-09-inst4.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-09-inst4-300x225.png" alt="" width="300" height="225" class="aligncenter size-medium wp-image-14298" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-09-inst4-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-09-inst4-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-09-inst4-1024x768.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-09-inst4.png 1026w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>and new ncurses: <a href="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-10-inst5.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-10-inst5-300x225.png" alt="" width="300" height="225" class="aligncenter size-medium wp-image-14299" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-10-inst5-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-10-inst5-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-10-inst5-1024x768.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-10-inst5.png 1026w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3 id="doomsday-preparations-retracted-packages">Doomsday Preparations: Retracted Packages</h3>
<p>If a maintenance update is released for any of our supported products, it may happen that after its release we realize that it introduces new problems, so we have to unpublish (retract) it.</p>
<p>So far, our maintenance team always managed to find other solutions, but sooner or later it will happen that it takes too long to realize that an update was broken, so users will install it.</p>
<p>For that purpose we introduced a new status <em>retracted</em> for patches and packages. We hope that we will never need it, but if we do, we need it in a hurry — until a better, fixed version of those packages is released.</p>
<p>We added new filters “Retracted Packages” and “Retracted Installed Packages” to the package selection, and the affected versions are colored in red and get a <strong>[RETRACTED]</strong> marker in the “Versions” tab:</p>
<figure><a href="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-11-retr.png"><img src="//lizards.opensuse.org/wp-content/uploads/2020/01/s92-11-retr-300x171.png" alt="" width="300" height="171" class="aligncenter size-medium wp-image-14300" srcset="https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-11-retr-300x171.png 300w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-11-retr-768x437.png 768w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-11-retr-1024x583.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2020/01/s92-11-retr.png 1087w" sizes="(max-width: 300px) 100vw, 300px" /></a><br />
</figure>
<p>Those lists should always be empty. Also, retracted versions will never automatically be installed. If package versions are retracted, but are already installed, the “Retracted Installed Packages” view will be opened automatically when starting the package selection to make you aware of them. Then you can choose to manually downgrade to a previous version or to wait until a fixed version is available.</p>
<p>In general, don’t worry: We never needed this so far, and we hope that we will never need it. Still, we take precautions for the worst case.</p>
<p>More details: <a href="https://github.com/libyui/libyui-qt-pkg/pull/82">PR 82</a></p>
<h3 id="qt-package-selection-gets-faster">Qt Package Selection Gets Faster</h3>
<p>This came as a byproduct of the previous item: While working on the new filter views for retracted packages, we found that it could take a long time (10-20 seconds) when switching away from the “All Packages” view, so we started digging deeper to find out why.</p>
<p>We found it strange that <em>clearing</em> the package list on the right side of that dialog was so slow; considerably slower than <em>filling</em> it with all packages. After some investigations, we found that in the course of all those changes for all those Qt versions (since Qt 3.x in mid-2006) some internal housekeeping for those list items was now no longer necessary because later Qt versions took over more and more of those responsibilities, and our own housekeeping now got in the way of that and was considerably slowing it down.</p>
<p>Once we found the cause, the fix was easy: We threw out our own housekeeping code and are now relying on what the Qt widget does, and hey presto, clearing that list now happens instantly instead of taking 10-20 seconds.</p>
<p>More details: <a href="https://github.com/libyui/libyui-qt-pkg/pull/82">PR 82 (“Other Fixes”)</a></p>
]]></content:encoded>
			</item>
		<item>
		<title>Highlights of YaST Development Sprint 91</title>
		<link>https://lizards.opensuse.org/2019/12/18/yast-sprint-91/</link>
		<comments>https://lizards.opensuse.org/2019/12/18/yast-sprint-91/#comments</comments>
		<pubDate>Wed, 18 Dec 2019 10:35:55 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Distribution]]></category>
		<category><![CDATA[Factory]]></category>
		<category><![CDATA[Programming]]></category>
		<category><![CDATA[Software Management]]></category>
		<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[YaST]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=14236</guid>
		<description><![CDATA[The last two weeks of the year, and also the first one of the new year, are vacation season in many parts of the world and YaSTland is not an exception. But before we enter hibernation mode, let&#8217;s take a look to the most important features and bugfixes we implemented in the last sprint of [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>The last two weeks of the year, and also the first one of the new year, are vacation season in many parts of the world and YaSTland is not an exception. But before we enter hibernation mode, let&#8217;s take a look to the most important features and bugfixes we implemented in the last sprint of 2019. That includes:</p>
<ul>
<li>bringing back to life some sections of the Software Manager,</li>
<li>implementing system upgrade with the new SLE media types,</li>
<li>making the installation in Raspberry Pi and IBM Z System even better,</li>
<li>improving usability of encryption,</li>
<li>reducing the footprint of the Snapper plugin for ZYpp,</li>
<li>as always, many other small improvements and fixes.</li>
</ul>
<h3>Restored Some Package Views: Recommended, Suggested, etc.</h3>
<p>Let&#8217;s start with a redemption story. Some time ago we implemented feature <a href="https://fate.suse.com/326485">fate#326485</a> which requested dropping the &#8220;Package Groups&#8221; view from the package manager UI. That was quite an easy task.</p>
<p>However, a few weeks later we got a bug report that the lists of recommended, suggested, etc&#8230; packages couldn&#8217;t be displayed anymore. It turned out that, in the Qt package manager front-end, the removed &#8220;Package Groups&#8221; view not only used to display the static group data from the packages but it also contained some special computed package lists like orphaned, suggested or recommended packages. So these lists were lost as a collateral damage of removing the &#8220;Package Groups&#8221; view.</p>
<p>The ncurses package manager was not affected by the same problem because, in that front-end, those views are grouped in a separate &#8220;Package Classification&#8221; section. So the task for this sprint was to somehow revive the lists in Qt and make them again available to the users.</p>
<p>We partly reverted the Package Groups removal and restored displaying those special package groups. To make it consistent we also use the &#8220;Package Classification&#8221; name for the view, like in the ncurses package manager.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/12/packages-qt.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/12/packages-qt-300x188.png" alt="The new Package Classification view in Qt" width="300" height="188" class="aligncenter size-medium wp-image-14238" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/12/packages-qt-300x188.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/12/packages-qt-768x481.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/12/packages-qt.png 775w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>On the other hand, the ncurses front-end was missing some lists like the &#8220;Multiversion Packages&#8221; and &#8220;All Packages&#8221;. To take consistency another step further, we added these missing lists and did some small cleanup and fixes so now both the Qt and the ncurses package managers should offer the same functionality and should look similar.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/12/packages-ncurses.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/12/packages-ncurses-300x197.png" alt="The revamped Package Classification view in ncurses" width="300" height="197" class="aligncenter size-medium wp-image-14239" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/12/packages-ncurses-300x197.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/12/packages-ncurses-768x505.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/12/packages-ncurses.png 802w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3>User-friendly Encryption Device Names</h3>
<p>And talking about bug reports that trigger some usability revamp, some users had pointed that, when the system is booting and prompts for the password of an encrypted device, it&#8217;s not always that easy to identify which exact device it is referring to:</p>
<p><img src="//lizards.opensuse.org/wp-content/uploads/2019/12/prompt-udev-1.png" alt="Booting password prompt before the change"></p>
<p>The root of the problem is that when YaST creates an encryption device (during the installation by means of the storage proposal, or manually with the Expert Partitioner), the device mapper name for the new encrypted device is generated from the udev id of the underlying device (e.g., <em>cr_ccw-0XAF5E-part2</em>).</p>
<p>We decided to improve the encryption naming generation in YaST for Tumbleweed and future releases of Leap and SLE. From now on, the name will be based on the mount point of the device. For example, if an encrypted device is going to be mounted at root, its device mapper name would be <em>cr_root</em>. In general, when the encrypted device is mounted, the device mapper name would be <em>cr_mount_point</em> (e.g., <em>cr_home_linux</em> for an encrypted device mounted at <em>/home/linux</em>).</p>
<p><img src="//lizards.opensuse.org/wp-content/uploads/2019/12/prompt-mountpoint-1.png" alt="Booting password prompt after the change"></p>
<p>Note that udev-based names might still be used for some scenarios. For example, when the device is not mounted or for an indirectly used encrypted device (e.g., an encrypted LVM Physical Volume).</p>
<p>And related to the identification of encryption devices, we have also added more information about the device when the encryption devices are activated during the installation process. Providing the password for the correct device was very difficult because the user needed to know the UUID of the encryption device. Now on, the activation popup also informs about the kernel name of the underlying device, making much easier to identify it.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/12/luks-activation.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/12/luks-activation-300x225.png" alt="New password prompt during installation" width="300" height="225" class="aligncenter size-medium wp-image-14249" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/12/luks-activation-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/12/luks-activation-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/12/luks-activation.png 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Because names matter&#8230; which leads us to the next topic.</p>
<h3>How does it Feel to Run a Mainframe?</h3>
<p>As you may know, (open)SUSE runs in a vast range of hardware, including powerful mainframes like the <a href="https://en.wikipedia.org/wiki/IBM_Z">IBM Z family</a>. One of the strengths of our beloved distributions is that, despite the differences in hardware and scope, the installation and usage experience is very similar in all the supported systems.</p>
<p>Consistency and ease of use are good, but when you drive a luxury car you want to see the brand&#8217;s badge on top of the hood. So in future versions of the installer, the model of the machine will be displayed when installing in an IBM Z system. See the right-top corner of the following screenshot.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/12/s390-qt.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/12/s390-qt-300x187.png" alt="IBM Z Model in the installer" width="300" height="187" class="aligncenter size-medium wp-image-14280" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/12/s390-qt-300x187.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/12/s390-qt-768x479.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/12/s390-qt-1024x639.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2019/12/s390-qt.png 1179w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>The text-based installer also has been modified to include the same banner in a similar place.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/12/s390-curses.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/12/s390-curses-300x61.png" alt="IBM Z Model in the text-mode installer" width="300" height="61" class="aligncenter size-medium wp-image-14281" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/12/s390-curses-300x61.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/12/s390-curses.png 515w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>But in the same way that (open)SUSE enables you to install and use Linux in a mainframe &#8220;just like in any other computer&#8221;, we also target to do the same in the other extreme of the hardware spectrum.</p>
<h3>Better Support for Raspberry Pi in the Partitioning Proposal</h3>
<p>One year ago <a href="https://lizards.opensuse.org/2018/12/04/highlights-of-yast-development-sprint-68/">we announced</a> that openSUSE Leap 15.1 and SLE-15-SP1 would be the first Linux distributions that could be installed in Raspberry Pi devices following the standard installation procedure, instead of deploying a Raspberry-specific pre-built image. The only prerequisite was the existence in the target SD card (or disk) of a partition containing the Raspberry Pi boot code.</p>
<p>But we are now able to go one step further for SLE-15-SP2 (and Leap 15.2). Thanks to the technologies included in those upcoming releases, (open)SUSE will not longer need a separate partition with the boot code in all cases. Now the installer can make a reasonable installation proposal in all situations, even if the target storage device doesn&#8217;t contain a booting partition in advance. See, for example, what the installer suggests by default for installing a fully standard SLE-15-SP2 Beta1 in a 32 GiB SD card that contained initially a GPT partition table (tip: GPT partition tables cannot be used to boot in a Raspberry Pi device&#8230; and the installer knows it).</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/12/proposal-32gb.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/12/proposal-32gb-300x203.png" alt="Installer proposal for a Raspberry Pi" width="300" height="203" class="aligncenter size-medium wp-image-14256" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/12/proposal-32gb-300x203.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/12/proposal-32gb.png 669w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>With that, the installation of the standard SLE-15-SP2 Beta1 (the aarch64 version, of course) in a Raspberry Pi 3 or 4 is as easy as &#8220;next&#8221;, &#8220;next&#8221;, &#8220;next&#8221;&#8230; with the only exception of a couple of packages that must be manually selected for installation (<code>raspberrypi-*</code> and <code>u-boot-rpi3</code>). Hopefully, future beta images of both SLE and openSUSE Leap 15.2 will select those packages automatically when installing in a Pi, which will make the (open)SUSE experience in those devices basically identical to any other computer. </p>
<h3>SLE Upgrade with the New Media Types</h3>
<p>And talking about the standard installation images of the upcoming SLE-15-SP2, we explained in <a href="https://lizards.opensuse.org/2019/12/05/yast-sprint-90/">our previous blog post</a> that those versions of SUSE Linux Enterprise (SLE) and all its associated products will be distributed in two new kinds of media &#8211; Full and Online. The Full Media contains many repositories and the system can be installed without network connectivity. The Online Media is similar to the openSUSE&#8217;s net installer, it contains no repository and it must download everything from the network. The big difference with openSUSE is that SLE systems need to be registered in order to have access to remote repositories.</p>
<p>But apart from installation, those two new media types can also be used to upgrade an existing system&#8230; at least after all the improvements implemented during the latest sprint.</p>
<p>In the case of the Online Media, if the system is registered the upgrade process will switch all repositories to point to their corresponding versions at the SUSE Customer Center (SCC) and will get the new software from there. If the system is not registered, the upgrade process is cancelled and the user is advised to either register the system or use the Full Media.</p>
<p>The Full Media can be used to upgrade any system, registered or not,  but the process is different in each case. For a non-registered system, the repositories will be switched to the ones included in the media and the system will be upgraded from there. For registered systems the process is the same that with the Online Media, so the software will be fetched from the remote repositories at the SUSE Customer Center.</p>
<p>Last but not least, we also made sure the process with both medias works with an AutoYaST upgrade (yes, you can also use AutoYaST to perform an unattended upgrade, in addition to the better known unattended installation). For a registered system, we simplified the   procedure as much as possible and it only needs access to SCC and an empty AutoYaST profile. For non-registered systems it is a little bit more complex because the profile must specify which repositories from the media should be used for the upgrade. But other than that, the process works quite smooth.</p>
<p>And, of course, we used the opportunity to improve the unit test coverage of the code and to improve the documentation, including the profiles we used for testing.</p>
<h3>The Snapper Plugin for ZYpp Becomes More Compact and Future-proof</h3>
<p><a href="http://snapper.io/">Snapper</a> lets you make filesystem snapshots. It has a companion, <code>snapper-zypp-plugin</code>, a plugin for <a href="https://en.opensuse.org/Portal:Libzypp">ZYpp</a> that makes snapshots automatically during commits. See the &#8220;zypp&#8221; descriptions in this listing:</p>
<pre><code>
# snapper list

  # | Type   |Pre # | Date                     | User | Used Space | Cleanup  | Description  | Userdata     
----+--------+------+--------------------------+------+------------+----------+--------------+-------------
  0 | single |      |                          | root |            |          | current      |              
[...]
824 | pre    |      | Tue Dec 17 10:00:27 2019 | root |  16.00 KiB | number   | zypp(zypper) | important=no
826 | post   |  824 | Tue Dec 17 10:02:19 2019 | root |  16.00 KiB | number   |              | important=no
827 | single |      | Tue Dec 17 11:00:01 2019 | root |  16.00 KiB | timeline | timeline     |             
828 | single |      | Tue Dec 17 11:00:01 2019 | root |  16.00 KiB | timeline | timeline     |             </code></pre>
<p>To make our enterprise products supportable for a looong time, we have rewritten this plugin to C++, starting with snapper-0.8.7. (The original Python implementation is not dead, it is resting in old Git commits.)</p>
<p>As a result, <a href="https://www.regular-expressions.info/python.html">Python regular expressions</a> are no longer supported in the <code>/etc/snapper/zypp.conf</code> file. <a href="https://www.regular-expressions.info/posix.html">POSIX extended regular expressions</a> work instead, which should work sufficiently well for the purpose of package name matching. <a href="http://man7.org/linux/man-pages/man7/glob.7.html" rel="nofollow">Shell patterns</a> continue working unchanged.</p>
<h3>Happy new year!</h3>
<p>During the following three weeks, the YaST team will interrupt the usual sprint-based development pace. That also means, almost for sure, that we will not publish any blog post about the development of YaST until mid January of 2020. So we want to take this opportunity to wish you a happy new year full of joy and Free Software.</p>
<p>See you soon and make sure to start the year with a lot of fun!</p>
]]></content:encoded>
			<wfw:commentRss>https://lizards.opensuse.org/2019/12/18/yast-sprint-91/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>Highlights of YaST Development Sprint 90</title>
		<link>https://lizards.opensuse.org/2019/12/05/yast-sprint-90/</link>
		<pubDate>Thu, 05 Dec 2019 14:21:25 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Base System]]></category>
		<category><![CDATA[Distribution]]></category>
		<category><![CDATA[Factory]]></category>
		<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[YaST]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=14198</guid>
		<description><![CDATA[As usual, during this sprint we have been working on a wide range of topics. The release of the next (open)SUSE versions is approaching and we need to pay attention to important changes like the new installation media or the /usr/etc and /etc split. Although we have been working on more stuff, we would like [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>As usual, during this sprint we have been working on a wide range of topics. The release of the next (open)SUSE versions is approaching and we need to pay attention to important changes like the new installation media or the /usr/etc and /etc split.</p>
<p>Although we have been working on more stuff, we would like to highlight these topics:</p>
<ul>
<li>Support for the new SLE installation media.</li>
<li>Proper handling of shadow suite settings.</li>
<li>Mount points handling improvements.</li>
<li>Help others to keep the Live Installation working.</li>
<li>Proper configuration of console fonts.</li>
<li>Better calculation of minimum and maximum sizes while resizing ext2/3/4 filesystems.</li>
<li>Small fixes in the network module.</li>
</ul>
<h3 id="the-new-online-and-full-sle-installation-media">The New Online and Full SLE Installation Media</h3>
<p>The upcoming Service Pack 2 of SUSE Linux Enterprise products will be released on two media types: <em>Online</em> and <em>Full</em>.</p>
<p>On the one hand, the <em>Online</em> medium does not contain any repository at all. They will be added from a registration server (SCC/SMT/RMT) after registering the selected base product. The <em>Online</em> medium is very small and contains only the files needed for booting the system and running the installer. On the other hand, the <em>Full</em> medium includes several repositories containing base products and several add-ons, which can help to save some bandwidth.</p>
<p>Obviously, as the installer is the same for both media types, we need to adapt it to make it work properly in all scenarios. This is an interesting challenge because the code is located in many YaST packages and at different places. Keep also in mind that the same installer needs to also work with the openSUSE Leap 15.2 product. That makes another set of scenarios which we need to support (or at least not to break).</p>
<p>The basic support is already there and we are now fine-tuning the details and corner cases, improving the user experience and so on.</p>
<h3 id="proper-handling-of-shadow-suite-settings">Proper Handling of Shadow Suite Settings</h3>
<p>A few weeks ago, we anticipated that (open)SUSE would split system&#8217;s configuration between <a href="https://lizards.opensuse.org/2019/10/09/highlights-of-yast-development-sprint-86#splitting-configuration-files-between-etc-and-usretc">/usr/etc and /etc directories</a>. The former will contain vendor settings and the latter will define host-specific settings.</p>
<p>One of the first packages to be changed was <code>shadow</code>, which stores now its default configuration in <code>/usr/etc/login.defs</code>. The problem is that YaST was not adapted in time and it was still trying to read settings only from <code>/etc/login.defs</code></p>
<p>During this sprint, we took the opportunity to fix this behavior and, what is more, to define a strategy to adapt the handling of other files in the future. In this case, YaST will take into account the settings from <code>/usr/etc</code> directory and it will write its changes to a dedicated <code>/etc/login.defs.d/70-yast.conf</code> file.</p>
<h3 id="missing-console-font-settings">Missing Console Font Settings</h3>
<p>The YaST team got a nice present this year (long before Christmas) thanks to <a href="https://github.com/jyeray">Joaquín</a>, who made an awesome <a href="https://github.com/yast/yast-country/pulls?q=is%3Apr+is%3Aclosed+author%3Ajyeray">contribution</a> to the YaST project by refactoring the keyboard management module. Thanks a lot, Joaquín!</p>
<p>We owe all of you a blog entry explaining the details but, for the time being, let&#8217;s say that now the module plays nicely with systemd.</p>
<p>After merging those changes, our QA team detected that the console font settings were not being applied correctly. Did you ever think about the importance of having the right font in the console? The problem was that the <a href="https://github.com/yast/yast.github.io/blob/master/doc/architecture.md#system-configuration-repository-scr">SCR agent</a> responsible for writing the <a href="https://www.freedesktop.org/software/systemd/man/vconsole.conf.html">configuration file for the virtual consoles</a> was removed. Fortunately, bringing back the deleted agent was enough to fix the problem, so your console will work fine again.</p>
<h3 id="helping-the-live-installation-to-survive">Helping the Live Installation to Survive</h3>
<p>Years ago, the YaST Team stopped supporting installation from the openSUSE live versions due to maintainability reasons. That has not stopped others from trying to keep the possibility open. Instead of fixing the old <code>LiveInstallation</code> mode of the installer, they have been adapting the live versions of openSUSE to include the regular installer and to be able to work with it.</p>
<p>Sometimes that reveals hidden bugs in the installer that nobody had noticed because they do not really affect the supported standard installation procedures. In this case, YaST was not always marking for installation in the target system all the packages needed by the storage stack. For example, the user could have decided to use Btrfs and still the installer would not automatically select to install the corresponding <code>btrfsprogs</code> package.</p>
<p>It happened because YaST was checking which packages were already installed and skipping them. That check makes sense when YaST is running in an already installed system and is harmless when performed in the standard installation media. But it was tricky in the live media. Now the check is skipped where it does not make sense and the live installation works reasonably well again.</p>
<h3 id="a-more-robust-yast-bootloader">A More Robust YaST Bootloader</h3>
<p>In order to perform any operation, the bootloader module of YaST first needs to inspect the disk layout of the system to determine which devices allocate the more relevant mount points like <code>/boot</code> or the root filesystem. The usage of Btrfs, with all its exclusive features like subvolumes and snapshots, has expanded the possibilities about how a Linux system can look in that regard. Sometimes, that meant YaST Bootloader was not able to clearly identify the root file system and it just crashed.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/12/missing-root-mount-point-error.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/12/missing-root-mount-point-error-300x222.png" alt="&quot;Missing &#039;/&#039; mount point&quot; error" width="300" height="222" class="aligncenter size-medium wp-image-14204" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/12/missing-root-mount-point-error-300x222.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/12/missing-root-mount-point-error.png 677w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Fortunately, those scenarios are reduced now to the very minimum thanks to all the adaptations and fixes introduced during this sprint regarding <a href="#improving-detection-of-mount-points">mount points detection</a>. But there is still a possibility in extreme cases like unfinished rollback procedures or very unusual subvolumes organization.</p>
<p>So, in addition to the mentioned improvements in <code>yast2-storage-ng</code>, we have also instructed <code>yast2-bootloader</code> to better deal with those unusual Btrfs scenarios, so it will find its way to the root file system, even if it’s tricky. That means the “missing ‘/’ mount point” errors should be gone for good.</p>
<p>But in case we overlooked something and there is still an open door to reach the same situation again in the future, we also have improved YaST to display an explanation and quit instead of crashing. Although we have done our best to ensure this blog entry will be the only chance for our users to see this new error pop-up.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/12/bootloader-root-file-system-not-found.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/12/bootloader-root-file-system-not-found-300x223.png" alt="YaST2 Bootloader: root file sytem not found" width="300" height="223" class="aligncenter size-medium wp-image-14206" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/12/bootloader-root-file-system-not-found-300x223.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/12/bootloader-root-file-system-not-found.png 677w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3 id="improving-detection-of-mount-points">Improving the Detection of Mount Points</h3>
<p>As mentioned above, improving the detection of mount points helped to prevent some problems that were affecting <code>yast2-bootloader</code>. However, that is not the only module that benefits from such changes.</p>
<p>When you run some clients like the <em>Expert Partitioner</em>, they automatically use the <em>libstorage-ng</em> library to discover all your storage devices. During that phase, <em>libstorage-ng</em> tries to find the mount points for all the file systems by inspecting <code>/etc/fstab</code> and <code>/proc/mounts</code> files. Normally, a file system is mounted only once, either at boot time or manually by the user. For the first case, both files <code>/etc/fstab</code> and <code>/proc/mounts</code> would contain an entry for the file system, for example:</p>
<pre><code>$ cat /etc/fstab
/dev/sda1  /  ext4  defaults  0  0

$ cat /proc/mounts
/dev/sda1 / ext4 rw,relatime 0 0
</code></pre>
<p>In the example above, <em>libstorage-ng</em> associates the <code>/</code> mount point to the file system which is placed on the partition <code>/dev/sda1</code>. But, what happens when the user bind-mounts a directory? In such a situation, <code>/proc/mounts</code> would contain two entries for the same device:</p>
<pre><code>$ mound /tmp/foo /mnt -o bind
$ cat /proc/mounts
/dev/sda1 / ext4 rw,relatime 0 0
/dev/sda1 /mnt ext4 rw,relatime 0 0
</code></pre>
<p>In the <em>Expert Partitioner</em>, that file system will appear as mounted at <code>/mnt</code> instead of <code>/</code>. So it will look like if your system did not have the root file system after all!</p>
<p>This issue was solved by improving the heuristic for associating mount points to the devices. Now, the <code>/etc/fstab</code> mount point is assigned to the device if that mount point also appears in the <code>/proc/mounts</code> file. That means, if a device is included in the <code>/etc/fstab</code> and the device is still mounted at that location, the <code>/etc/fstab</code> mount point takes precedence.</p>
<p>As a bonus, and also related to mount points handling, now the <em>Expert Partitioner</em> is able to detect the situation where, after performing a snapshot-based rollback, the system has not been rebooted. As a result, it will display a nice and informative message to the user.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/12/not-rebooted-after-rollback.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/12/not-rebooted-after-rollback-300x225.png" alt="System not rebooted after snapshot rollback" width="300" height="225" class="aligncenter size-medium wp-image-14214" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/12/not-rebooted-after-rollback-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/12/not-rebooted-after-rollback-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/12/not-rebooted-after-rollback.png 800w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3 id="improved-calculation-of-minimum-and-maximum-sizes-for-ext234g">Improved Calculation of Minimum and Maximum Sizes for ext2/3/4</h3>
<p>If you want to resize a filesystem using YaST, it needs to find out the minimum and maximum sizes for the given filesystem. Until now, the estimation for ext2/3/4 was based on the <code>statvfs</code> system call and it <a href="https://bugzilla.suse.com/show_bug.cgi?id=1149148">did not work well at all</a>.</p>
<p>Recently, we have improved YaST to use the value reported by <code>resize2fs</code> as the minimum size which is more precise. Additionally, YaST checks now the block size and whether the 64bit feature is on to calculate the maximum size.</p>
<h3 id="polishing-the-network-module">Polishing the Network Module</h3>
<p>As part of our recent network module refactorization, we have improved the workflow of wireless devices configuration, among other UI changes. Usually, these changes are controversial and, as a consequence, we received a few bug reports about some missing steps that are actually not needed anymore. However, checking those bugs allowed us to find some small UI glitches, like a problem with the <em>Authentication Mode</em> widget.</p>
<p>Moreover, we have used this sprint to drop the support for some deprecated device types, like Token Ring or FDDI. Below you can see how bad the device type selection looks now. But fear not! We are aware and we will give it some love during the next sprint.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/12/network-device-type-selection.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/12/network-device-type-selection-300x173.png" alt="Network Device Type Selection" width="300" height="173" class="aligncenter size-medium wp-image-14216" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/12/network-device-type-selection-300x173.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/12/network-device-type-selection-768x442.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/12/network-device-type-selection-1024x590.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2019/12/network-device-type-selection.png 1344w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3 id="conclusions">Conclusions</h3>
<p>The last sprint of the year is already in progress. This time, we are still polishing our storage and network stacks, improving the migration procedure, and fixing several miscelaneous issues. We will give you all the details in two weeks through our next sprint report. Until then, have a lot of fun!</p>
]]></content:encoded>
			</item>
		<item>
		<title>Highlights of YaST Development Sprints 88 and 89</title>
		<link>https://lizards.opensuse.org/2019/11/22/highlights-of-yast-development-sprints-88-and-89/</link>
		<pubDate>Fri, 22 Nov 2019 14:13:35 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[YaST]]></category>
		<category><![CDATA[autoyast]]></category>
		<category><![CDATA[CSV]]></category>
		<category><![CDATA[encryption]]></category>
		<category><![CDATA[GUI]]></category>
		<category><![CDATA[JSON]]></category>
		<category><![CDATA[partitioner]]></category>
		<category><![CDATA[roles]]></category>
		<category><![CDATA[snapper]]></category>
		<category><![CDATA[storage]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=14176</guid>
		<description><![CDATA[The System Role selection dialog got usability improvements and we added a CustomStatusItemSelector to the widget library in the process. Snapper gained machine-readable output Storage: remote encrypted devices are activated properly at boot time random and pervasive encryption also supported in AutoYaST improved support for AutoYaST Guided Partitioning A More User Friendly Role Selector Dialog [&#8230;]]]></description>
				<content:encoded><![CDATA[<ul>
<li>The <a href="#roles">System Role</a> selection dialog got usability improvements
<ul>
<li>and we added a <a href="#widget">CustomStatusItemSelector</a> to the widget library in the process.</li>
</ul>
</li>
<li>Snapper gained <a href="#snapper">machine-readable output</a></li>
<li>Storage:
<ul>
<li><a href="#netdev">remote encrypted devices</a> are activated properly at boot time</li>
<li><a href="#encryption">random and pervasive encryption</a> also supported in AutoYaST</li>
<li>improved support for <a href="#guided">AutoYaST Guided Partitioning</a></li>
</ul>
</li>
</ul>
<h3 id="a-more-user-friendly-role-selector-dialog">A More User Friendly Role Selector Dialog</h3>
<p><a name="roles"></a> Step by step, we continue improving the user experience making use of the newly added widgets to libyui. This sprint was the turn to update the role selection dialog to use the <a href="https://lizards.opensuse.org/2019/10/23/yast-sprint-87/">new item selector introduced during the sprint 87</a>. Apart from looking better as it can be seen in the screenshots below, there are two immediate improvements:</p>
<ul>
<li>the vertical scroll, when present, is respected after selecting a role (instead of “jumping to the beginning”), and</li>
<li>the selected role (if any) will be visible when arriving at the dialog even when the list is quite long or the available space too short.</li>
</ul>
<table>
<tr>
<td>Before</td>
<td>After</td>
</tr>
<tr>
<td><a href="//lizards.opensuse.org/wp-content/uploads/2019/11/s89-roles1.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/11/s89-roles1-300x225.png" alt="" width="300" height="225" class="aligncenter size-medium wp-image-14194" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/11/s89-roles1-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/11/s89-roles1-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/11/s89-roles1.png 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a></td>
<td><a href="//lizards.opensuse.org/wp-content/uploads/2019/11/s89-roles2.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/11/s89-roles2-300x225.png" alt="" width="300" height="225" class="aligncenter size-medium wp-image-14195" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/11/s89-roles2-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/11/s89-roles2-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/11/s89-roles2.png 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a></td>
</tr>
</table>
<p>What is more, updating the dialog was also useful for us to realize about some needed improvements for the widget itself, mentioned in the next section. Quite a productive <a href="https://github.com/yast/yast-installation/pull/827">change</a> <img src="https://s.w.org/images/core/emoji/2.2.1/72x72/1f642.png" alt="&#x1f642;" class="wp-smiley" style="height: 1em; max-height: 1em;" /></p>
<h3 id="when-one-bit-is-not-enough-the-customstatusitemselector">When one Bit is not Enough: The CustomStatusItemSelector</h3>
<p><a name="widget"></a> A few weeks ago, we wrote about the new <em>ItemSelector</em> widget that is finding its way into YaST user interfaces. It turned out that just a simple on/off status is not enough in some cases, so we had to extend that concept. For example, software modules may have dependencies, and we want to show the difference between one that was explicitly selected by the user and one that was auto-selected because some other software module requires it.</p>
<figure><a href="//lizards.opensuse.org/wp-content/uploads/2019/11/s89-selector-qt.png"><img class="aligncenter size-medium wp-image-14181" src="//lizards.opensuse.org/wp-content/uploads/2019/11/s89-selector-qt-236x300.png" alt="" width="236" height="300" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/11/s89-selector-qt-236x300.png 236w, https://lizards.opensuse.org/wp-content/uploads/2019/11/s89-selector-qt.png 520w" sizes="(max-width: 236px) 100vw, 236px" /></a></figure>
<figure><a href="//lizards.opensuse.org/wp-content/uploads/2019/11/s89-selector-curses.png"><img class="aligncenter size-medium wp-image-14180" src="//lizards.opensuse.org/wp-content/uploads/2019/11/s89-selector-curses-300x215.png" alt="" width="300" height="215" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/11/s89-selector-curses-300x215.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/11/s89-selector-curses-768x549.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/11/s89-selector-curses.png 966w" sizes="(max-width: 300px) 100vw, 300px" /></a></figure>
<p>This kind of shook the foundations of the underlying classes; all of a sudden a bit is no longer just a bit, but it needs to be broken down into even smaller pieces. Well, we cheated; we now use integer values instead. Most of the class hierarchy still only uses 0 and 1, but the new <em>YCustomStatusItemSelector</em> also supports using higher numbers for application-defined purposes.</p>
<p>For each possible status value, the application defines the name of the icon to be displayed (for graphical UIs like the Qt UI), the text equivalent (for text mode / the NCurses UI), and an optional <em>nextStatus</em> which tells the widget what status to cycle to when the user changes the status of an item with a mouse click or with the keyboard. A value of -1 lets the application handle this.</p>
<p>So this is not a one-trick-pony that is useful only for that one use case (the software modules), but a generic tool that might find good uses in other places all over YaST as well.</p>
<p>Usage examples: <a href="https://github.com/libyui/libyui/blob/master/examples/CustomStatusItemSelector1.cc">C++</a>, <a href="https://github.com/yast/yast-ycp-ui-bindings/blob/master/examples/CustomStatusItemSelector1.rb">Ruby</a>.</p>
<h3 id="snapper-and-machine-readable-output">Snapper and Machine-readable Output</h3>
<p><a name="snapper"></a> Most likely you already know <a href="http://snapper.io/"><em>snapper</em></a>, a great tool to work with your filesystem snapshots. Some third-party scripts and tools (e.g., YaST) use the <em>snapper</em> <abbr title="command line interface">CLI</abbr> to get some information, but generally, <em>snapper</em> generates an output intended to be human-readable. Sometimes that could cause some troubles in scripts checking the <em>snapper</em> output. Now on, <em>snapper</em> also offers CLI options to generate its output in a machine-readable format, i.e., CSV and JSON. Please, check <a href="http://snapper.io/2019/11/06/machine-readable-output.html">this post</a> for more information about those new options.</p>
<h3 id="fix-boot-problems-with-remote-encrypted-devices">Fix Boot Problems with Remote Encrypted Devices</h3>
<p><a name="netdev"></a> Since we adopted systemd, the management during system boot of encrypted devices on top of network-based devices like <a href="https://en.wikipedia.org/wiki/ISCSI">iSCSI</a> or <a href="https://en.wikipedia.org/wiki/Fibre_Channel_over_Ethernet">FCoE</a> disks has been less than optimal. But now we are happy to announce that we have put all the pieces together to make the experience as smooth as possible.</p>
<p>One of the main responsibilities of systemd is sorting the actions performed during boot and setting the dependencies between them. For example, if there are encrypted devices, systemd will first ask you for the password and activate the devices to afterwards mount the file system contained in those encrypted devices. Systemd should be able to distinguish when an encrypted device is based on a network-based storage device and, thus, can only be initialized after the network is up. In some cases that detection failed (for example network block device based mounts, such as iSCSI and FCoE disks) and systemd got stuck before initializing the network waiting for the device to be available.</p>
<p>Recently, SLE and openSUSE Leap has incorporated support for specifying the <a href="https://www.freedesktop.org/software/systemd/man/crypttab.html#_netdev"><code>_netdev</code> option in the <code>/etc/crypttab</code> file</a>. With such option, systemd will recognize the encrypted device as network-based and will only try to activate it after setting up the network. That’s analogous to the corresponding <code>_netdev</code> option in <code>/etc/fstab</code> that has been already there for quite some time and that can be used to defer when a device is mounted. For it to work properly, the <code>_netdev</code> option must be present in all the relevant entries of both <code>crypttab</code> and <code>fstab</code>.</p>
<p>And that’s exactly what YaST will do now in openSUSE Tumbleweed and upcoming releases of both SLE and openSUSE Leap. From now on, the <code>_netdev</code> option will be added <code>fstab</code> for all mount points depending (directly or indirectly) on the network. In addition, that option (and also the <code>noauto</code> and <code>nofail</code> ones) will be propagated from <code>fstab</code> to all the corresponding <code>crypttab</code> entries.</p>
<p>This should mark the end of a dark age of encrypted iSCSI and FCoE devices timing out during boot.</p>
<h3 id="autoyast-support-for-random-and-pervasive-encryption">AutoYaST Support for Random and Pervasive Encryption</h3>
<p><a name="encryption"></a> Back in October, we announced that <a href="https://lizards.opensuse.org/2019/10/09/advanced-encryption-yast/">YaST got support for new encryption methods</a> like random or pervasive encryption. At that time, AutoYaST was out of scope because we wanted to have a stable (and tested) API first. Fortunately, the time has come and now AutoYaST supports these encryption mechanisms.</p>
<p>Starting in autoyast2 4.2.17, you can specify the encryption method using a <code>crypt_method</code> element, as shown in the example below. Possible values are <code>luks1</code> (regular LUKS1 encryption), <code>pervasive_luks2</code> (pervasive volume encryption), <code>protected_swap</code> (encryption with volatile protected key), <code>secure_swap</code> (encryption with volatile secure key) and <code>random_swap</code> (encryption with volatile random key).</p>
<div id="cb1" class="sourceCode">
<pre class="sourceCode xml"><code class="sourceCode xml"><a id="cb1-1" class="sourceLine" title="1"></a>    <span class="kw">&lt;drive&gt;</span>
<a id="cb1-2" class="sourceLine" title="2"></a>     <span class="kw">&lt;type</span><span class="ot"> config:type=</span><span class="st">"symbol"</span><span class="kw">&gt;</span>CT_DISK<span class="kw">&lt;/type&gt;</span>
<a id="cb1-3" class="sourceLine" title="3"></a>     <span class="kw">&lt;use&gt;</span>all<span class="kw">&lt;/use&gt;</span>
<a id="cb1-4" class="sourceLine" title="4"></a>     <span class="kw">&lt;partitions</span><span class="ot"> config:type=</span><span class="st">"list"</span><span class="kw">&gt;</span>
<a id="cb1-5" class="sourceLine" title="5"></a>      <span class="kw">&lt;partition&gt;</span>
<a id="cb1-6" class="sourceLine" title="6"></a>       <span class="kw">&lt;size&gt;</span>20G<span class="kw">&lt;/size&gt;</span>
<a id="cb1-7" class="sourceLine" title="7"></a>       <span class="kw">&lt;mount&gt;</span>/<span class="kw">&lt;/mount&gt;</span>
<a id="cb1-8" class="sourceLine" title="8"></a>       <span class="kw">&lt;filesystem</span><span class="ot"> config:type=</span><span class="st">"symbol"</span><span class="kw">&gt;</span>ext4<span class="kw">&lt;/filesystem&gt;</span>
<a id="cb1-9" class="sourceLine" title="9"></a>       <span class="kw">&lt;crypt_method</span><span class="ot"> config:type=</span><span class="st">"symbol"</span><span class="kw">&gt;</span>luks1<span class="kw">&lt;/crypt_method&gt;</span> <span class="co">&lt;!-- default method if crypt_key is defined --&gt;</span>
<a id="cb1-10" class="sourceLine" title="10"></a>       <span class="kw">&lt;crypt_key&gt;</span>S3CR3T<span class="kw">&lt;/crypt_key&gt;</span>
<a id="cb1-11" class="sourceLine" title="11"></a>      <span class="kw">&lt;/partition&gt;</span>
<a id="cb1-12" class="sourceLine" title="12"></a>      <span class="kw">&lt;partition&gt;</span>
<a id="cb1-13" class="sourceLine" title="13"></a>       <span class="kw">&lt;size&gt;</span>1G<span class="kw">&lt;/size&gt;</span>
<a id="cb1-14" class="sourceLine" title="14"></a>       <span class="kw">&lt;mount&gt;</span>swap<span class="kw">&lt;/mount&gt;</span>
<a id="cb1-15" class="sourceLine" title="15"></a>       <span class="kw">&lt;crypt_method</span><span class="ot"> config:type=</span><span class="st">"symbol"</span><span class="kw">&gt;</span>random_swap<span class="kw">&lt;/crypt_method&gt;</span> <span class="co">&lt;!-- set encryption method --&gt;</span>
<a id="cb1-16" class="sourceLine" title="16"></a>      <span class="kw">&lt;/partition&gt;</span>
<a id="cb1-17" class="sourceLine" title="17"></a>     <span class="kw">&lt;/partitions&gt;</span>
<a id="cb1-18" class="sourceLine" title="18"></a>    <span class="kw">&lt;/drive&gt;</span></code></pre>
</div>
<p>As we want AutoYaST to be as user-friendly as possible, it will try to help you if you do some mistake setting the encryption configuration as when in the screenshot below.</p>
<figure><a href="//lizards.opensuse.org/wp-content/uploads/2019/11/s89-ay-encryption.png"><img class="aligncenter size-medium wp-image-14179" src="//lizards.opensuse.org/wp-content/uploads/2019/11/s89-ay-encryption-300x225.png" alt="" width="300" height="225" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/11/s89-ay-encryption-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/11/s89-ay-encryption-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/11/s89-ay-encryption.png 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a></figure>
<p>Finally, the old <code>crypt_fs</code> element is deprecated, although it stills works for backward-compatibility reasons. Basically, it is equivalent to setting <code>crypt_method</code> to <code>luks1</code>.</p>
<h3 id="improve-support-for-autoyast-guided-partitioning">Improve Support for AutoYaST Guided Partitioning</h3>
<p><a name="guided"></a> When it comes to partitioning, we can categorize AutoYaST use cases into three different levels:</p>
<ul>
<li>Automatic partitioning: the user does not care about the partitioning and trusts in AutoYaST to do the right thing.</li>
<li>Guided partitioning: the user would like to set some basic settings (use LVM, set an encryption password, etc.)</li>
<li>Expert partitioning: the user specifies how the layout should look, although a complete definition is not required.</li>
</ul>
<p>To some extent, it is like using the regular installer where you can skip the partitioning screen and trust in YaST, use the Guided Proposal, or define the partitioning layout through the Expert Partitioner.</p>
<p>The second level (Guided partitioning) was introduced in AutoYaST with the release of SUSE Linux Enteprise 15 (and Leap 15.0) but it was not documented at all. Additionally, although it was working as designed at first sight, it was far from being that useful.</p>
<p>This sprint with invested quite some time improving the documentation (kudos to our awesome documentation team) and the behaviour. Now, if you want to set up an LVM system without having the specify all the details, you can use the following snippet in your profile:</p>
<div id="cb2" class="sourceCode">
<pre class="sourceCode xml"><code class="sourceCode xml"><a id="cb2-1" class="sourceLine" title="1"></a><span class="kw">&lt;general&gt;</span>
<a id="cb2-2" class="sourceLine" title="2"></a>  <span class="kw">&lt;storage&gt;</span>
<a id="cb2-3" class="sourceLine" title="3"></a>    <span class="kw">&lt;lvm</span><span class="ot"> config:type=</span><span class="st">"boolean"</span><span class="kw">&gt;</span>true<span class="kw">&lt;/lvm&gt;</span>
<a id="cb2-4" class="sourceLine" title="4"></a>  <span class="kw">&lt;/storage&gt;</span>
<a id="cb2-5" class="sourceLine" title="5"></a><span class="kw">&lt;/general&gt;</span></code></pre>
</div>
<p>If you are interested in the available options, you can check the <a href="https://susedoc.github.io/doc-sle/master/SLES-autoyast/html/configuration.html#CreateProfile-Partitioning">documentation draft</a>.</p>
]]></content:encoded>
			</item>
		<item>
		<title>Highlights of YaST Development Sprint 87</title>
		<link>https://lizards.opensuse.org/2019/10/23/yast-sprint-87/</link>
		<comments>https://lizards.opensuse.org/2019/10/23/yast-sprint-87/#comments</comments>
		<pubDate>Wed, 23 Oct 2019 14:02:18 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Distribution]]></category>
		<category><![CDATA[Factory]]></category>
		<category><![CDATA[Programming]]></category>
		<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[YaST]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=14141</guid>
		<description><![CDATA[It&#8217;s time for another YaST team report! Let&#8217;s see what&#8217;s on the menu today. More news and improvements in the storage area, specially regarding encryption support. Some polishing of the behavior of YaST Network. New widgets in libYUI. A look into systemd timers and how we are using them to replace cron. And a new [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>It&#8217;s time for another YaST team report! Let&#8217;s see what&#8217;s on the menu today.</p>
<ul>
<li>More news and improvements in the storage area, specially regarding encryption support.</li>
<li>Some polishing of the behavior of YaST Network.</li>
<li>New widgets in libYUI.</li>
<li>A look into systemd timers and how we are using them to replace <code>cron</code>.</li>
<li>And a new cool tool for developers who have to deal with complex object-oriented code!</li>
</ul>
<p>So let&#8217;s go for it all.</p>
<h3>Performance Improvements in Encrypted Devices</h3>
<p>As you may know, we have recently extended YaST to support additional encryption mechanisms like volatile encryption for swap devices or pervasive encryption for data volumes. You can find more details in our blog post titled &quot;<a href="https://lizards.opensuse.org/2019/10/09/advanced-encryption-yast/">Advanced Encryption Options Land in the YaST Partitioner</a>&quot;.</p>
<p>Those encryption mechanisms offer the possibility of adjusting the sector size of the encryption layer according to the sector size of the disk. That can result in a performance boost with storage devices based on 4k blocks. To get the best of your systems, we have instructed YaST to set the sector size to 4096 bytes whenever is possible, which should improve the performance of the encrypted devices created with the recently implemented methods.</p>
<p>Additionally, we took the time to improve the codebase related to encryption, based on the lessons we learned while implementing volatile and pervasive encryption. We also performed some additional tests and we found <a href="https://bugzilla.suse.com/show_bug.cgi?id=1154267">a problem</a> that we are already fixing in the sprint that has just started.</p>
<h3>Other improvements related to encryption</h3>
<p>One of those lessons we have learnt recently is that resizing a device encrypted with a LUKS2 encryption layer works slightly different to the traditional LUKS1 case. With LUKS2 the password must be provided in the moment of resizing, even if the device is already open and active. So we changed how libstorage-ng handles the passwords provided by the user to make it possible to resize LUKS2 devices in several situations, although there are still some cases in which it will not be possible to use the YaST Partitioner to resize a LUKS2 device.</p>
<p>As a side effect of the new passwords management, now the process that analyzes the storage devices at the beginning of the installation should be more pleasant in scenarios like the one described in the <a href="https://bugzesilla.suse.com/show_bug.cgi?id=1129496">report of bug#1129496</a>, where there are many encrypted devices but the user doesn&#8217;t want to activate them all.</p>
<p>And talking about improvements based on our users&#8217; feedback, we have also adapted the names of the new methods for encrypting swap with volatile keys, as suggested in the comments of our already mentioned previous blog post. We also took the opportunity to improve the corresponding warning messages and help texts.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/10/volatile.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/10/volatile-300x226.png" alt="New name and description for encryption with volatile keys" width="300" height="226" class="aligncenter size-medium wp-image-14160" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/10/volatile-300x226.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/10/volatile-768x579.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/10/volatile.png 801w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3>Network and Dependencies Between Devices</h3>
<p>Similar to encryption, the network backend is another area that needed some final adjustments after the big implementation done in the previous sprints. In particular, we wanted to improve the management of devices that depend on other network devices, like VLANs (virtual LANs) or bridges. </p>
<p>Historically, YaST has simply kept the name of the device as a dependency, even if such device does not exist any longer. That leaded to inconsistent states. Now the dependencies are updated dynamically. If the user renames a device, then it&#8217;s automatically renamed in all its dependencies. If the user deletes a device that is needed by any other one, YaST will immediately ask the user whether to modify (in the case of bonding and bridges) or to remove (in the case of VLANs) those dependent devices.</p>
<h3>New libYUI Widget: ItemSelector</h3>
<p>Now that we mention the user experience, it&#8217;s fair to note that it has been quite a while since we created the last new widget for libYUI, our YaST UI toolkit. But we identified a need for a widget that lets the user select one or many from a number of items with not only a short title, but also a descriptive text for each one (and optionally an icon), and that can scroll if there are more items than fit on the screen.</p>
<p>So say hello to the new <code>SingleItemSelector</code>.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/10/single-qt.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/10/single-qt-300x215.png" alt="SingleItemSelector in graphical mode" width="300" height="215" class="aligncenter size-medium wp-image-14146" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/10/single-qt-300x215.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/10/single-qt.png 552w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>As you would expect from any libYUI widget, there is also a text-based (ncurses) alternative.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/10/single-ncurses.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/10/single-ncurses-300x176.png" alt="SingleItemSelector in text mode" width="300" height="176" class="aligncenter size-medium wp-image-14147" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/10/single-ncurses-300x176.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/10/single-ncurses.png 640w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Please, note the screenshots above are just short usage examples. We are NOT planning to bring back the desktop selection screen. On the other hand, now we have the opportunity to make a prettier screen to select the computer role. Stay tuned for more news about that.</p>
<p>There is also an alternative version of the new widget that allows to select several items. The unsurprisingly named <code>MultiItemSelector</code>.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/10/multi-qt.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/10/multi-qt-300x227.png" alt="MultiItemSelector in graphical mode" width="300" height="227" class="aligncenter size-medium wp-image-14148" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/10/multi-qt-300x227.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/10/multi-qt.png 351w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Which, of course, also comes with an ncurses version.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/10/multi-ncurses.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/10/multi-ncurses-300x176.png" alt="MultiItemSelector in text mode" width="300" height="176" class="aligncenter size-medium wp-image-14149" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/10/multi-ncurses-300x176.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/10/multi-ncurses.png 641w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>In the near future, we are planning to use that for selecting products and add-on modules. But this kind of widgets will find other uses as well.</p>
<h3>Fun with Systemd Timers</h3>
<p>And talking about the close future, many of you may know there is a plan coming together to replace the usage of <code>cron</code> with systemd timers as the default mechanism for (open)SUSE packages to execute periodic tasks.</p>
<p>In our case, we decided to start the change with <code>yast2-ntp-client</code>, which offers the possibility to synchronize the system time once in a while. So let&#8217;s take a look to how systemd timers work and how we used them to replace <code>cron</code>.</p>
<p>When defining a service in systemd it is possible to specify a type for that service to define how it behaves. When started, a service of type <code>oneshot</code> will simply execute some action and then finish. Those services can be combined with the timers, which invoke any service according to monotonous clock with a given cadence. To make that cadence configurable by the user, the YaST module overrides the default timer with another one located at <code>/etc/systemd/system</code>.</p>
<p>As a note for anyone else migrating to systemd timers, our first though was to use the <code>EnvironmentFile</code> directive instead of overriding the timer. But that seems to not be possible for timers.</p>
<p>One clear advantage of using a systemd service to implement this is the possibility of specifying dependencies and relations with other services. In our case, that allows us to specify that one time synchronization cannot be used if the chrony daemon is running, since they would both conflict. So the new system is slightly more complex than a one-liner cron script, but it&#8217;s also more descriptive and solid.</p>
<p>And another tip for anyone dealing with one-shot services and systemd timers, you can use <code>systemd-cat</code> to catch the output of any script and redirect it to the systemd journal.</p>
<h3>Everybody Loves Diagrams</h3>
<p>But apart from tips for sysadmins and packagers, we also have some content for our fellow developers. You know YaST is a huge project that tries to manage all kind of inter-related pieces. Often, the average YaST developer needs to jump into some complex module. Code documentation can help to know your way around YaST internals that you don&#8217;t work with every day. To generate such documentation, we use the <a href="https://yardoc.org/">YARD</a> tool, and its output is for example here, for <a href="https://www.rubydoc.info/github/yast/yast-network">yast-network</a>. Still, for large modules with many small classes, this is not enough to get a good overview.</p>
<p>Enter <a href="https://github.com/mvidner/yard-medoosa">yard-medoosa</a>, a plugin for YARD that automatically creates <a href="https://en.wikipedia.org/wiki/Class_diagram">UML class diagrams</a>, clickable to get you to the classes textual documentation.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/10/medoosa.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/10/medoosa-300x35.png" alt="The yast2-network medoosa" width="300" height="35" class="aligncenter size-medium wp-image-14153" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/10/medoosa-300x35.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/10/medoosa-768x89.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/10/medoosa-1024x118.png 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>It is still a prototype but it has proven useful for navigating a certain large pull request. We hope to soon tell you about an improved version.</p>
<h3>More Solid Device Names in fstab and crypttab</h3>
<p>Back to topics related to storage management, you surely know there are several ways to specify a device to be mounted in the <code>/etc/fstab</code> file or a device to be activated in the <code>/etc/crypttab</code>. Apart from using directly the name of the device (like <code>/dev/sda1</code>) or any of its alternative names based on udev, you can also use the UUID or the label of the file-system or of the LUKS device.</p>
<p>By default, YaST will use the udev path in s390 systems and the UUID in any other architecture. Although that&#8217;s something that can be configured modifying the <code>/etc/sysconfig/storage</code> file or simply using this screen of the Partitioner, which makes possible to change how the installation (both the Guided Setup and the Expert Partitioner) writes the resulting <code>fstab</code> and <code>crypttab</code> files.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/10/mount_by_setting.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/10/mount_by_setting-300x225.png" alt="Changing the way devices are referenced" width="300" height="225" class="aligncenter size-medium wp-image-14162" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/10/mount_by_setting-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/10/mount_by_setting-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/10/mount_by_setting.png 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>But, what happens when the default option (like the udev path) is not a valid option for some particular device? So far, YaST simply used the device name (e.g. <code>/dev/sda1</code>) as an immediate fallback. That happened at the very end of the process, when already writing the changes to disk.</p>
<p>We have improved that for Tumbleweed, for SLE-15-SP1 (which implies Leap 15.1) and for the upcoming versions of (open)SUSE. Now, if the default value is not suitable for a particular device because the corresponding udev path does not exists, because using a given name is incompatible with the chosen encryption method, or for any other reason, YaST will fall back to the most reasonable and stable alternative. And it will do it from the very beginning of the process, being immediately visible in the Partitioner.</p>
<h3>Stay Tuned for More&#8230; and Stay Communicative</h3>
<p>As usual, when we publish our sprint report we are already working on the next development sprint. So in approximately two weeks you will have more news about our work, this time likely with a strong focus in AutoYaST.</p>
<p>Don&#8217;t forget to keep providing us feedback. As commented above, it&#8217;s very valuable for us and we really use it as an input to plan subsequent development sprints.</p>
]]></content:encoded>
			<wfw:commentRss>https://lizards.opensuse.org/2019/10/23/yast-sprint-87/feed/</wfw:commentRss>
		<slash:comments>1</slash:comments>
		</item>
		<item>
		<title>Highlights of YaST Development Sprint 86</title>
		<link>https://lizards.opensuse.org/2019/10/09/highlights-of-yast-development-sprint-86/</link>
		<pubDate>Wed, 09 Oct 2019 13:43:53 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Uncategorized]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=14109</guid>
		<description><![CDATA[Now that you had a chance to look at our post about Advanced Encryption Options (especially if you are an s390 user), it is time to check what happened during the last YaST development sprint, which finished last Monday. As usual, we have been working in a wide range of topics which include: Improving support [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>Now that you had a chance to look at <a href="https://lizards.opensuse.org/2019/10/09/advanced-encryption-yast/">our post about Advanced Encryption Options</a> (especially if you are an s390 user), it is time to check what happened during the last YaST development sprint, which finished last Monday.</p>
<p>As usual, we have been working in a wide range of topics which include:</p>
<ul>
<li>Improving support for multi-device file systems in the expert partitioner.</li>
<li>Fixing networking, secure boot and kdump problems in AutoYaST.</li>
<li>Stop waiting for <code>chrony</code> during initial boot when it does not make sense.</li>
<li>Preparing to support the split of configuration files between <code>/usr/etc</code> and <code>/etc</code>.</li>
<li>Using <code>/etc/sysctl.d</code> to write YaST related settings instead of the <code>/etc/sysctl.conf</code> main file.</li>
</ul>
<h3 id="expert-partitioner-and-multi-device-file-systems">Expert Partitioner and Multi-Device File Systems</h3>
<p>So far, the Expert Partitioner was assuming that Btrfs was the only file system built on top multiple devices. But that is not completely true because some file systems are able to use an external journal to accomplish a better performance. For example, <em>Ext3/4</em> and <em>XFS</em> can be configured to use separate devices for data and the journaling stuff.</p>
<p>We received a <a href="https://bugzilla.suse.com/show_bug.cgi?id=1145841">bug report</a> caused by this misunderstanding about multi-device file systems. The Expert Partitioner was labeling as “Part of Btrfs” a device used as an external journal of an <em>Ext4</em> file system. So we have improved this during the last sprint, and now external journal devices are correctly indicated in the <em>Type</em> column of the Expert Partitioner, as shown in the screenshot below.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/10/yast2-storage-ng-type-for-external-journal-devices.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/10/yast2-storage-ng-type-for-external-journal-devices-300x225.png" alt="External Journal Type" width="300" height="225" class="aligncenter size-medium wp-image-14114" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/10/yast2-storage-ng-type-for-external-journal-devices-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/10/yast2-storage-ng-type-for-external-journal-devices-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/10/yast2-storage-ng-type-for-external-journal-devices.png 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Moreover, the file system information now indicates which device is being used for the external journal.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/10/yast2-storage-ng-external-journal-device-details.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/10/yast2-storage-ng-external-journal-device-details-300x225.png" alt="External Journal Device Details" width="300" height="225" class="aligncenter size-medium wp-image-14115" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/10/yast2-storage-ng-external-journal-device-details-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/10/yast2-storage-ng-external-journal-device-details-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/10/yast2-storage-ng-external-journal-device-details.png 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>And finally, we have also limited the usage of such devices belonging to a multi-device Btrfs. Now, you will get an error message if you try to edit one of those devices. In the future, we will extend this feature to make possible to modify file systems using an external journal from the Expert Partitioner.</p>
<h3 id="autoyast-getting-some-love">AutoYaST Getting Some Love</h3>
<p>During this sprint, we have given AutoYaST some attention in different areas: networking, bootloader and kdump.</p>
<p>About the networking area, we have finished s390 support in the new network layer, fixing some old limitations in devices activation and udev handling. Apart from that, we have fixed several bugs and improved the documentation a lot, as we found it to be rather incomplete.</p>
<p>Another important change was adding support to disable secure boot for UEFI through AutoYaST. Of course, we updated the documentation too and, during the process, we added some elements that were missing and removed others that are not needed anymore.</p>
<p>Finally, we fixed a tricky problem when trying to get kdump to work on a minimal system. After some debugging, we found out that AutoYaST adds too late <code>kdump</code> to the list of packages to install. This issue has been fixed and now it should work like a charm.</p>
<p>As you may have seen, apart from writing code, we try to contribute to the documentation so our users have a good source of information. If you are curious, apart from the documents for released <a href="https://suse.com/documentation">SUSE</a> and <a href="https://doc.opensuse.org/">openSUSE</a> versions, you can check the <a href="https://susedoc.github.io/">latest builds</a> (including the <a href="https://susedoc.github.io/doc-sle/master/SLES-autoyast/html">AutoYaST handbook</a>). Kudos to our documentation team for such an awesome work!</p>
<h3 id="avoiding-chrony-wait-time-out">Avoiding <code>chrony-wait</code> time out</h3>
<p>Recently, some openSUSE users reported a really annoying issue in Tumbleweed. When time synchronization is enabled through YaST, the system might get stuck during the booting process if no network connection is available.</p>
<p>The problem is that, apart from the <code>chrony</code> service, YaST was enabling the <code>chrony-wait</code> service too. This service is used to ensure that the time is properly set before continuing with other services that can be affected by a time shift. But without a network connection, <code>chrony-wait</code> will wait for around 10 minutes. Unacceptable.</p>
<p>The discussion about the proper fix for this bug is still open, but for the time being, we have applied a workaround in YaST to enable <code>chrony-wait</code> only for those products that require precise time, like openSUSE Kubic. In the rest of cases, systems will boot faster even without network, although some service might be affected by a time shift.</p>
<h3 id="splitting-configuration-files-between-etc-and-usretc">Splitting Configuration Files between <code>/etc</code> and <code>/usr/etc</code></h3>
<p>As Linux users, we are all used to check for system-wide settings under <code>/etc</code>, which contains a mix of vendor and host-specific configuration values. This approach has worked rather well in the past, not without some hiccups, but when things like <a href="https://en.opensuse.org/openSUSE:Packaging_for_transactional-updates">transactional updates</a> come into play, the situation gets messy.</p>
<p>In order to solve those problems, the plan is to split configuration files between <code>/etc</code> and <code>/usr/etc</code>. The former would contain vendor settings while the latter would define host-specific values. Of course, such a move have a lot of implications.</p>
<p>So during this sprint we tried to identify potential problems for YaST and to propose solutions to tackle them in the future. If you are interested in the technical details, you can read <a href="https://github.com/yast/yast-yast2/blob/2975c70ab17f1bc790c0ca3e77ff7a0d14a08266/doc/etc-and-usr-etc.md">our conclusions</a>.</p>
<h3 id="writing-sysctl-changes-to-etcsysctld">Writing Sysctl Changes to <code>/etc/sysctl.d</code></h3>
<p>In order to be able to cope with the <code>/etc</code> and <code>/usr/etc</code> split, YaST needs to stop writing to files like <code>/etc/sysctl.conf</code> and use an specific file under <code>.d</code> directories (like <code>/etc/sysctl.d</code>).</p>
<p>So as part of the aforementioned research, we adapted several modules (<code>yast2-network</code>, <code>yast2-tune</code>, <code>yast2-security</code> and <code>yast2-vpn</code>) to behave this way regarding <code>/etc/sysctl.conf</code>. From now on, YaST specific settings will be written to <code>/etc/sysctl.d/30-yast.conf</code> instead of <code>/etc/sysctl.conf</code>. Moreover, if YaST founds any of those settings in the general <code>.conf</code> file, it will move them to the new place.</p>
<h3>What&#8217;s next?</h3>
<p>Sprint 87 is already running. Apart from fixing some bugs that were introduced during the network refactoring, we plan to work on other storage-related stuff like resizing support for LUKS2 or some small snapper problems. We will give your more details in our next sprint report.</p>
<p>Stay tunned!</p>
]]></content:encoded>
			</item>
		<item>
		<title>Advanced Encryption Options Land in the YaST Partitioner</title>
		<link>https://lizards.opensuse.org/2019/10/09/advanced-encryption-yast/</link>
		<comments>https://lizards.opensuse.org/2019/10/09/advanced-encryption-yast/#comments</comments>
		<pubDate>Wed, 09 Oct 2019 10:07:42 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Distribution]]></category>
		<category><![CDATA[Factory]]></category>
		<category><![CDATA[Programming]]></category>
		<category><![CDATA[Security]]></category>
		<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[YaST]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=14054</guid>
		<description><![CDATA[Welcome to a new sneak peek on the YaST improvements you will enjoy in SLE-15-SP2 and openSUSE Leap 15.2&#8230; or much earlier if you, as most YaST developers, are a happy user of openSUSE Tumbleweed. In our report of the 84th sprint we mentioned some changes regarding the encryption capabilities of the YaST Partitioner, like [&#8230;]]]></description>
				<content:encoded><![CDATA[<p>Welcome to a new sneak peek on the YaST improvements you will enjoy in SLE-15-SP2 and openSUSE Leap 15.2&#8230; or much earlier if you, as most YaST developers, are a happy user of openSUSE Tumbleweed.</p>
<p>In <a href="https://lizards.opensuse.org/2019/09/16/yast-sprint-84/">our report of the 84th sprint</a> we mentioned some changes regarding the encryption capabilities of the YaST Partitioner, like displaying the concrete encryption technology or the possibility to keep an existing encryption layer.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/09/part-reencrypt.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/09/part-reencrypt-300x189.png" alt="Keeping the previous encryption layer" width="300" height="189" class="aligncenter size-medium wp-image-14042" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/09/part-reencrypt-300x189.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/09/part-reencrypt-768x483.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/09/part-reencrypt.png 958w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>And the <a href="https://lizards.opensuse.org/2019/09/26/highlights-of-yast-development-sprint-85/">report of sprint 85</a> contained a promise about a separate blog post detailing the new possibilities we have been adding when it comes to create encrypted devices.</p>
<p>So here we go! But let&#8217;s start with a small disclaimer. Although some of the new options are available for all (open)SUSE users, it&#8217;s fair to say that this time the main beneficiaries are the users of s390 systems, which may enjoy up to four new ways of encrypting their devices.</p>
<h3>Good Things don&#8217;t Need to Change</h3>
<p>As you may know, so far the YaST Partitioner offered an &#8220;Encrypt Device&#8221; checkbox when creating or editing a block device. If such box is marked, the Partitioner asks for an encryption password and creates a LUKS virtual device on top of the device being encrypted.</p>
<p>LUKS (<a href="https://gitlab.com/cryptsetup/cryptsetup/wikis/home">Linux Unified Key Setup</a>) is the standard for Linux hard disk encryption. By providing a standard on-disk-format, it facilitates compatibility among distributions. LUKS stores all necessary setup information in the partition header, enabling to transport or migrate data seamlessly. So far, there are two format specifications for such header: LUKS1 and LUKS2. YaST uses LUKS1 because is established, solid and well-known, being fully compatible with the (open)SUSE installation process and perfectly supported by all the system tools and by most bootloaders, like Grub2.</p>
<p>You should not fix what is not broken. Thus, in most cases, the screen for encrypting a device has not changed at all and it still works exactly in the same way under the hood.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/09/part-edit-crypt.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/09/part-edit-crypt-300x188.png" alt="Editing an encrypted device" width="300" height="188" class="aligncenter size-medium wp-image-14041" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/09/part-edit-crypt-300x188.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/09/part-edit-crypt-768x481.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/09/part-edit-crypt.png 958w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>But using an alternative approach may be useful for some use cases, and we wanted to offer an option in the Partitioner for those who look for something else. So in some special cases that screen will include a new selector to choose the encryption method. Let&#8217;s analyze all those new methods.</p>
<h3>Volatile Swap Encryption with a Random Key</h3>
<p>When a swap device has been marked to be encrypted, the user will be able to choose between &#8220;Regular LUKS1&#8221; and &#8220;Volatile Encryption with Random Key&#8221;. Both options will be there for swap devices on all hardware architectures. The first option simply uses the classical approach described above.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/10/prvasive1.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/10/prvasive1-300x225.png" alt="Selecting the encryption method" width="300" height="225" class="aligncenter size-medium wp-image-14102" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/10/prvasive1-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/10/prvasive1-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/10/prvasive1.png 800w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>The second one allows to configure the system in a way in which the swap device is re-encrypted on every boot with a new randomly generated password.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/10/prvasive2.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/10/prvasive2-300x225.png" alt="Encrypt swap with a random password" width="300" height="225" class="aligncenter size-medium wp-image-14103" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/10/prvasive2-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/10/prvasive2-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/10/prvasive2.png 800w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Some advanced users may point that configuring such a random encryption for swap was already possible in versions of openSUSE prior to Leap 15.0. But the procedure to do so was obscure to say the least. The encryption with a random password was achieved by simply leaving blank the &#8220;Enter a Password&#8221; field in the encryption step. The exact implications were not explained anywhere in the interface and the help text didn&#8217;t mention all the risks.</p>
<p>Now the same configuration can be achieved with a more explicit interface, relevant information is provided as you can see in the screenshot below and some extra internal controls are in place to try to limit the potential harm.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/10/prvasive3.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/10/prvasive3-300x225.png" alt="Help text for the random swap method" width="300" height="225" class="aligncenter size-medium wp-image-14104" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/10/prvasive3-300x225.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/10/prvasive3-768x576.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/10/prvasive3.png 800w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>With this approach, the key used to encrypt the content of the swap is generated on every boot using <code>/dev/urandom</code> which is extremely secure. But you can always go a bit further&#8230;</p>
<h3>Swap Encryption with Volatile Protected AES Keys</h3>
<p>One of the nice things about having a <a href="https://en.wikipedia.org/wiki/Mainframe_computer">mainframe computer</a> (and believe us there are MANY nice things) is the extra security measures implemented at all levels. In the case of IBM Z or IBM LinuxONE that translates into the so-called <a href="https://www.ibm.com/support/knowledgecenter/linuxonibm/liaaf/lnz_r_crypt.html">pervasive encryption</a>. Pervasive encryption is an infrastructure for end-to-end data protection. It includes data encryption with protected and secure keys.</p>
<p>In s390 systems offering that technology, the swap can be encrypted on every boot using a volatile protected AES key, which offers an extra level of security compared to regular encryption using data from <code>/dev/urandom</code>. <a href="https://www.ibm.com/support/knowledgecenter/linuxonibm/com.ibm.linux.z.lxdc/lxdc_swapdisks.html">This document</a> explains how to setup such system by hand. But now you can just use YaST and configure everything with a single click, as shown in the following screenshot.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/10/perv-swap-protected.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/10/perv-swap-protected-300x179.png" alt="Encrypting swap with volatile protected keys" width="300" height="179" class="aligncenter size-medium wp-image-14095" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/10/perv-swap-protected-300x179.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/10/perv-swap-protected-768x458.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/10/perv-swap-protected.png 802w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>The good thing about this method is that you can use it even if your s390 system does not have a CCA cryptographic coprocessor. Oh, wait&#8230; you may not know what a cryptographic coprocessor is. Don&#8217;t worry, just keep reading.</p>
<h3>Pervasive Encryption for Data Volumes</h3>
<p>Have you ever wondered how James Bond would protect his information from the most twisted and resourceful villains? We don&#8217;t know for sure (or, at least, we are supposed to not disclosure that information), but we would bet he has an s390 system with at least one Crypto Express cryptographic coprocessor configured in CCA mode (shortly referred as a CCA coprocessor).</p>
<p>Those dedicated pieces of hardware, when properly combined with CPU with <a href="https://www.ibm.com/support/knowledgecenter/en/SSLTBW_2.1.0/com.ibm.zos.v2r1.csfb300/csfb3za218.htm">CPACF</a> support, make sure the information at-rest in any storage device can only be read in the very same system where that information was encrypted. They even have a physical mechanism to destroy all the keys when the hardware is removed from the machine, like the self-destruction mechanisms in the spy movies!</p>
<p>As <a href="https://www.ibm.com/support/knowledgecenter/linuxonibm/liaaf/lnz_r_dccnt.html">documented here</a>, the process to enjoy the full power of pervasive encryption for data volumes in Linux can be slightly complex&#8230; unless you have the YaST Partitioner at hand!</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/09/pervasive.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/09/pervasive-300x178.png" alt="Pervasive volume encryption" width="300" height="178" class="aligncenter size-medium wp-image-14078" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/09/pervasive-300x178.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/09/pervasive-768x455.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/09/pervasive.png 803w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>As you can see in the screenshot above, the process with YaST is as simple as choosing &#8220;Pervasive Volume Encryption&#8221; instead of the classic LUKS1 that YaST uses regularly for non-swap volumes. If YaST finds in the system a secure AES key already associated to the volume being encrypted, it will use that key and the resulting encryption device will have the DeviceMapper name specified for that key. If such secure keys don&#8217;t exist, YaST will automatically register a new one for each volume.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/09/pervasive_help.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/09/pervasive_help-300x194.png" alt="Help for pervasive volume encryption" width="300" height="194" class="aligncenter size-medium wp-image-14077" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/09/pervasive_help-300x194.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/09/pervasive_help-768x496.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/09/pervasive_help.png 854w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Pervasive encryption can be used on any volume of the system, even the root partition.</p>
<h3>I want it all!</h3>
<p>So far we have seen you can use protected AES keys for randomly encrypting swap and registered secure keys for protecting data volumes. But what if you want your swap to be randomly encrypted with a volatile secure AES key? After all, you have already invested time and money installing those great CCA coprocessors, let&#8217;s use them also for the random swap encryption!</p>
<p>If your hardware supports it, when encrypting the swap you will see a &#8220;Volatile Encryption with Secure Key&#8221; option, in addition to the other four possibilities commented above. As easy as it gets!</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/10/perv-swap-secure.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/10/perv-swap-secure-300x178.png" alt="All possible methods for encrypting a swap" width="300" height="178" class="aligncenter size-medium wp-image-14096" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/10/perv-swap-secure-300x178.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/10/perv-swap-secure-768x457.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/10/perv-swap-secure.png 802w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<h3>More Booting Checks in non-s390 Systems</h3>
<p>As described in the help for pervasive volume encryption showed above, that encryption method uses LUKS2 under the hood. So we took the opportunity to improve the Partitioner checks about encryption and booting. Now, in any architecture that is not s390 the following warning will be displayed if the expert partitioner is used to place the root directory in a LUKS2 device without a separate plain <code>/boot</code>.</p>
<p><a href="//lizards.opensuse.org/wp-content/uploads/2019/09/luks2_warning.jpg"><img src="//lizards.opensuse.org/wp-content/uploads/2019/09/luks2_warning-300x233.jpg" alt="New check for booting" width="300" height="233" class="aligncenter size-medium wp-image-14076" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/09/luks2_warning-300x233.jpg 300w, https://lizards.opensuse.org/wp-content/uploads/2019/09/luks2_warning-768x597.jpg 768w, https://lizards.opensuse.org/wp-content/uploads/2019/09/luks2_warning.jpg 1024w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>As mentioned, that doesn&#8217;t apply to s390 mainframes. The usage of <code>zipl</code> makes possible to boot Linux in those systems as long as the kernel supports the encryption technology, independently of the Grub2 (lack of) capabilities.</p>
<h3>What&#8217;s next?</h3>
<p>We are still working to smooth off the rough edges of the new encryption methods offered by YaST and to add AutoYaST support for them. You may have noticed that most of the improvements currently implemented will only directly benefit s390 systems&#8230; even just a subset of those. But at the current stage, we already have built the foundation for a new era of encryption support in YaSTland.</p>
<p>We are thinking about adding more encryption methods that could be useful for all (open)SUSE users, with general support for LUKS2 being an obvious candidate. But that&#8217;s not something we will see in the short term because there are many details to iron up first in those technologies to make then fit nicely into the current installation process.</p>
<p>But hey, meanwhile you can play with all the other new toys!</p>
]]></content:encoded>
			<wfw:commentRss>https://lizards.opensuse.org/2019/10/09/advanced-encryption-yast/feed/</wfw:commentRss>
		<slash:comments>2</slash:comments>
		</item>
		<item>
		<title>Highlights of YaST Development Sprint 85</title>
		<link>https://lizards.opensuse.org/2019/09/26/highlights-of-yast-development-sprint-85/</link>
		<pubDate>Thu, 26 Sep 2019 08:22:24 +0000</pubDate>
		<dc:creator><![CDATA[Yast Team]]></dc:creator>
				<category><![CDATA[Systems Management]]></category>
		<category><![CDATA[YaST]]></category>
		<category><![CDATA[bonding]]></category>
		<category><![CDATA[graph]]></category>
		<category><![CDATA[networking]]></category>
		<category><![CDATA[openqa]]></category>
		<category><![CDATA[refactoring]]></category>
		<category><![CDATA[resolver]]></category>
		<category><![CDATA[storage]]></category>
		<category><![CDATA[vlan]]></category>
		<category><![CDATA[zoom]]></category>

		<guid isPermaLink="false">http://lizards.opensuse.org/?p=14083</guid>
		<description><![CDATA[Encryption got so many improvements that we are writing a separate post (stay tuned). Refactored Network on its way to Tumbleweed. When you fix a corner case, automatic tests will break in a different corner. Not only in flight simulators but also in storage device graphs it matters which way is up and which is [&#8230;]]]></description>
				<content:encoded><![CDATA[<ul>
<li><a href="#FIXME">Encryption</a> got so many improvements that we are writing a separate post (stay tuned).</li>
<li><a href="#s85-net">Refactored Network on its way to Tumbleweed</a>.</li>
<li>When you fix a corner case, <a href="#s85-openqa">automatic tests will break in a different corner</a>.</li>
<li>Not only in flight simulators but also in storage device graphs <a href="#s85-zoom">it matters which way is up and which is down</a>.</li>
</ul>
<h3 id="refactored-network-on-its-way-to-tumbleweed">Refactored Network on its way to Tumbleweed<a name="s85-net"></a></h3>
<p>A few weeks ago we submitted the first round of changes to the network module to Tumbleweed. At that point, it was still using the old data model for most operations (except routing and DNS handling) and a lot of work remained to be done.</p>
<p>We have been working hard on improving the overall quality of this module and we will submit an updated (and much improved) version in the upcoming days. To summarize, here are some highlights:</p>
<ul>
<li>Completed the new data model (support for TUN/TAP, bridges, bonding, VLANs, etc.).</li>
<li>New wireless configuration workflow.</li>
<li>Revamped support for interface renaming and driver assignment, including better udev rule handling.</li>
<li>Fixed <code>/etc/hosts</code> handling when switching from static to DHCP based configuration.</li>
<li>Many small fixes in several areas.</li>
</ul>
<p>Are we done with the refactoring? No, we are still working on improving S390 support and fixing small issues, but most of the work is already done.</p>
<p>Of course, as soon as we finish, we will publish a blog entry with the gory details. But, as we know that you love screenshots, let us show you a handful of them.</p>
<p>Although we have not introduced big user interface changes, we have tried to improve small things, like properly displaying whether an interface belongs to a VLAN or hiding the &quot;Hardware&quot; tab for virtual interfaces.</p>
<div class="figure"><a href="//lizards.opensuse.org/wp-content/uploads/2019/09/s85-network-ng-enslaved.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/09/s85-network-ng-enslaved-300x217.png" alt="" width="300" height="217" class="aligncenter size-medium wp-image-14085" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/09/s85-network-ng-enslaved-300x217.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/09/s85-network-ng-enslaved-768x557.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/09/s85-network-ng-enslaved-1024x742.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2019/09/s85-network-ng-enslaved.png 1025w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<div class="figure"><a href="//lizards.opensuse.org/wp-content/uploads/2019/09/s85-network-ng-bond.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/09/s85-network-ng-bond-300x217.png" alt="" width="300" height="217" class="aligncenter size-medium wp-image-14086" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/09/s85-network-ng-bond-300x217.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/09/s85-network-ng-bond-768x557.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/09/s85-network-ng-bond-1024x742.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2019/09/s85-network-ng-bond.png 1025w" sizes="(max-width: 300px) 100vw, 300px" /></a>
</div>
<h3 id="dns-resolution-not-working-during-installation-or-openqa-is-different">DNS resolution not working during installation, or: openQA is different<a name="s85-openqa"></a></h3>
<p>When we got a bug report that DNS resolution was not working during installation (since SLE-15 apparently), a solution seemed straightforward: <code>/run/netconfig/resolv.conf</code> was missing because the <code>/run</code> directory was not mirrored (bind-mounted) into the target system. That&#8217;s a task that used to be done by yast-storage in times before SLE-15 and was for some unknown reason forgotten when we implemented yast-storage-ng. A <a href="https://github.com/yast/yast-storage-ng/pull/958">one-line fix</a> was easily done, tested, and submitted.</p>
<p>Or so it seemed.</p>
<p>A few days later we got reports from SLE <a href="https://openqa.opensuse.org/">openQA</a> that tests started to fail with this patch. Nothing networking related but the installation did not finish because the 10 seconds countdown dialog (&#8216;going to reboot&#8217;) at the very end of the installation was frozen. The UI didn&#8217;t accept any input whatsoever. But whatever we tried, the issue was not reproducible outside openQA. <a href="https://en.opensuse.org/openSUSE:Report_a_YaST_bug">YaST logs</a> from openQA showed that <code>/run</code> got mounted as planned and was cleanly unmounted at the end of the installation &#8211; before that frozen dialog. So no clue so far and the issue was set aside for a while. Until the same reports came in from Tumbleweed testing. It was clearly linked to this one-line patch. But how?</p>
<p>It stayed a mystery until a chat with an openQA expert shed some light on the issue. What we <em>thought</em> was happening was: openQA stopped the dialog (by pressing a button) and when it tried to go on the OK button did not respond anymore. What we learned <em>does</em> actually happen is this: openQA stops the dialog, then <a href="https://github.com/os-autoinst/os-autoinst-distri-opensuse/blob/5ab5f605c178189a0cadc40624e2b76ae61e29c9/tests/installation/logs_from_installation_system.pm#L34">switches from X to the text console</a>, <a href="https://github.com/os-autoinst/os-autoinst-distri-opensuse/blob/5ab5f605c178189a0cadc40624e2b76ae61e29c9/tests/installation/logs_from_installation_system.pm#L57">collects logs</a>, switches back to X, and <em>then</em> the UI does not respond anymore. So that was quite an essential point missing.</p>
<p>And with this it was easily reproduced outside openQA: the X logs showed that the X server lost all its input devices after the switch. And that was because someone had deleted the whole <code>/run</code> directory. The YaST logs didn&#8217;t contain a hint (of course not, would have been too easy) but grepping the sources found the place where YaST deleted the directory.</p>
<p>The code had been added after complaints that the installation left a cluttered <code>/run</code> directory &#8211; of course the installation did leave files there, since it was forgotten to bind-mount the directory. So once the mentioned patch bind-mounted it again the deletion code cleaned up not <code>/run</code> in the installation target system but the real <code>/run</code> as well &#8211; cutting off the X server from the outside world resulting in freezing the openQA test.</p>
<p>And the moral of <a href="https://github.com/yast/yast-installation/pull/811">the story</a> is: probably none. But it highlights again that the automated test setup can have unexpected feedback on the test itself. Luckily in this case, as the issue would not have been noticed otherwise.</p>
<h3 id="computer-enlarge-the-device-graph">Computer, Enlarge the Device Graph<a name="s85-zoom"></a></h3>
<p>The partitioner module has a graphical view to help you see the relations in more complex storage setups:</p>
<div class="figure"><a href="//lizards.opensuse.org/wp-content/uploads/2019/09/s85-scrolldir.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/09/s85-scrolldir-300x232.png" alt="" width="300" height="232" class="aligncenter size-medium wp-image-14087" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/09/s85-scrolldir-300x232.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/09/s85-scrolldir-768x594.png 768w, https://lizards.opensuse.org/wp-content/uploads/2019/09/s85-scrolldir.png 807w" sizes="(max-width: 300px) 100vw, 300px" /></a>
</div>
<p>If you turn the mouse scroll wheel up or down, we will zoom the view in or out. Now the direction matches the behavior in web browsers and online maps, previously we had it the wrong way around.</p>
<p><strong>Update</strong>: during proofreading, a team mate told me: &quot;A device graph? That&#8217;s not a device graph. <a href="https://www.youtube.com/watch?v=POJtaO2xB_o">THAT&#8217;s</a> a device graph:&quot;</p>
<div class="figure"><a href="//lizards.opensuse.org/wp-content/uploads/2019/09/s85-thats-a-graph.png"><img src="//lizards.opensuse.org/wp-content/uploads/2019/09/s85-thats-a-graph-1024x80.png" alt="" width="1024" height="80" class="aligncenter size-large wp-image-14088" srcset="https://lizards.opensuse.org/wp-content/uploads/2019/09/s85-thats-a-graph-1024x80.png 1024w, https://lizards.opensuse.org/wp-content/uploads/2019/09/s85-thats-a-graph-300x24.png 300w, https://lizards.opensuse.org/wp-content/uploads/2019/09/s85-thats-a-graph-768x60.png 768w" sizes="(max-width: 1024px) 100vw, 1024px" /></a>
</div>
]]></content:encoded>
			</item>
	</channel>
</rss>
